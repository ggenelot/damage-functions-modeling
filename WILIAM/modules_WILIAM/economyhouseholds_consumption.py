"""
Module economyhouseholds_consumption
Translated using PySD version 3.14.0
"""

@component.add(
    name="adjustment factor households consumption to avoid negative assets",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="Smooth",
    depends_on={
        "_smooth_adjustment_factor_households_consumption_to_avoid_negative_assets": 1
    },
    other_deps={
        "_smooth_adjustment_factor_households_consumption_to_avoid_negative_assets": {
            "initial": {
                "adjustment_factor_households_consumption_to_avoid_negative_assets_non_smooth": 1
            },
            "step": {
                "adjustment_factor_households_consumption_to_avoid_negative_assets_non_smooth": 1
            },
        }
    },
)
def adjustment_factor_households_consumption_to_avoid_negative_assets():
    """
    Correction factor of consumption to avoid negative fiancnial assets. When net lending is negative and in absoulte figures is twice the volume of assets we downscale the consumption to be equal to dispoable income
    """
    return _smooth_adjustment_factor_households_consumption_to_avoid_negative_assets()


_smooth_adjustment_factor_households_consumption_to_avoid_negative_assets = Smooth(
    lambda: adjustment_factor_households_consumption_to_avoid_negative_assets_non_smooth(),
    lambda: xr.DataArray(
        2,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    ),
    lambda: adjustment_factor_households_consumption_to_avoid_negative_assets_non_smooth(),
    lambda: 1,
    "_smooth_adjustment_factor_households_consumption_to_avoid_negative_assets",
)


@component.add(
    name="adjustment factor households consumption to avoid negative assets non smooth",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "delayed_ts_households_net_lending": 1,
        "delayed_ts_households_financial_assets": 1,
        "initial_households_financial_assets_per_household": 1,
        "delayed_ts_total_households_consumption_coicop": 1,
        "delayed_ts_households_disposable_income": 1,
    },
)
def adjustment_factor_households_consumption_to_avoid_negative_assets_non_smooth():
    """
    Correction factor of consumption to avoid negative fiancnial assets. When financial assets are lower than 0.5 initial assets we downscale the consumption to be equal to disposable income
    """
    return if_then_else(
        np.logical_and(
            time() > 2015,
            np.logical_and(
                delayed_ts_households_net_lending() < 0,
                delayed_ts_households_financial_assets()
                < 0.5 * initial_households_financial_assets_per_household(),
            ),
        ),
        lambda: zidz(
            delayed_ts_households_disposable_income(),
            delayed_ts_total_households_consumption_coicop(),
        ),
        lambda: xr.DataArray(
            1,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I"],
        ),
    )


@component.add(
    name="adjustment factor labour compensation",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "delayed_ts_labour_compensation_total": 1,
        "labour_compensation_non_adjusted": 1,
    },
)
def adjustment_factor_labour_compensation():
    """
    Adjustment factor for labour compensation
    """
    return zidz(
        delayed_ts_labour_compensation_total(), labour_compensation_non_adjusted()
    )


@component.add(
    name="adjustment factor net operating surplus",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "delayed_ts_total_net_operating_surplus_distributed_to_households": 1,
        "tax_income_corporations": 1,
        "share_operating_surplus_distributed": 1,
        "net_operating_surplus_non_adjusted": 1,
    },
)
def adjustment_factor_net_operating_surplus():
    """
    Adjustment factor of net operating surplus
    """
    return zidz(
        (
            delayed_ts_total_net_operating_surplus_distributed_to_households()
            - tax_income_corporations()
        )
        * share_operating_surplus_distributed(),
        net_operating_surplus_non_adjusted(),
    )


@component.add(
    name="adjustment factor social benefits",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"social_benefits": 1, "social_benefits_non_adjusted": 1},
)
def adjustment_factor_social_benefits():
    """
    Adjustment factor for social benefits
    """
    return zidz(social_benefits(), social_benefits_non_adjusted())


@component.add(
    name="annual growth households consumption durables real",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "aux_households_consumption_durables_real": 1,
        "aux_delayed_households_consumption_durables_real": 1,
    },
)
def annual_growth_households_consumption_durables_real():
    """
    Annual growth households consumption propensity of durable goods
    """
    return (
        zidz(
            aux_households_consumption_durables_real(),
            aux_delayed_households_consumption_durables_real(),
        )
        - 1
    )


@component.add(
    name="annual growth households consumption non durables real",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "aux_households_consumption_non_durables_real": 1,
        "aux_delayed_households_consumption_non_durables_real": 1,
    },
)
def annual_growth_households_consumption_non_durables_real():
    """
    Annual growth households consumption propensity of durable goods
    """
    return (
        zidz(
            aux_households_consumption_non_durables_real(),
            aux_delayed_households_consumption_non_durables_real(),
        )
        - 1
    )


@component.add(
    name="aux delayed households consumption durables real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_aux_delayed_households_consumption_durables_real": 1},
    other_deps={
        "_delayfixed_aux_delayed_households_consumption_durables_real": {
            "initial": {"initial_households_consumption_durables_real": 1},
            "step": {"aux_households_consumption_durables_real": 1},
        }
    },
)
def aux_delayed_households_consumption_durables_real():
    """
    Delayed households consumption propensity of durable goods: non smooth
    """
    return _delayfixed_aux_delayed_households_consumption_durables_real()


_delayfixed_aux_delayed_households_consumption_durables_real = DelayFixed(
    lambda: aux_households_consumption_durables_real(),
    lambda: 1,
    lambda: initial_households_consumption_durables_real(),
    time_step,
    "_delayfixed_aux_delayed_households_consumption_durables_real",
)


@component.add(
    name="aux delayed households consumption non durables real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_aux_delayed_households_consumption_non_durables_real": 1},
    other_deps={
        "_delayfixed_aux_delayed_households_consumption_non_durables_real": {
            "initial": {"initial_households_consumption_non_durables_real": 1},
            "step": {"aux_households_consumption_non_durables_real": 1},
        }
    },
)
def aux_delayed_households_consumption_non_durables_real():
    """
    Delayed households consumption propensity of durable goods: non smooth
    """
    return _delayfixed_aux_delayed_households_consumption_non_durables_real()


_delayfixed_aux_delayed_households_consumption_non_durables_real = DelayFixed(
    lambda: aux_households_consumption_non_durables_real(),
    lambda: 1,
    lambda: initial_households_consumption_non_durables_real(),
    time_step,
    "_delayfixed_aux_delayed_households_consumption_non_durables_real",
)


@component.add(
    name="aux households consumption durables real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_propensity_durables": 4,
        "households_disposable_income_real": 4,
        "initial_households_consumption_propensity_durables": 3,
    },
)
def aux_households_consumption_durables_real():
    """
    Households consumption of durables by household type in real terms.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    )
    except_subs = xr.ones_like(value, dtype=bool)
    except_subs.loc[["LROW"], :, :] = False
    except_subs.loc[["LATAM"], :, :] = False
    except_subs.loc[["INDIA"], :, :] = False
    value.values[except_subs.values] = (
        households_consumption_propensity_durables()
        * households_disposable_income_real()
    ).values[except_subs.values]
    value.loc[["LROW"], :, :] = (
        (
            np.maximum(
                initial_households_consumption_propensity_durables()
                .loc["LROW", :, :]
                .reset_coords(drop=True),
                households_consumption_propensity_durables()
                .loc["LROW", :, :]
                .reset_coords(drop=True),
            )
            * households_disposable_income_real().loc["LROW", :].reset_coords(drop=True)
        )
        .expand_dims({"REGIONS 35 I": ["LROW"]}, 0)
        .values
    )
    value.loc[["LATAM"], :, :] = (
        (
            np.maximum(
                initial_households_consumption_propensity_durables()
                .loc["LATAM", :, :]
                .reset_coords(drop=True),
                households_consumption_propensity_durables()
                .loc["LATAM", :, :]
                .reset_coords(drop=True),
            )
            * households_disposable_income_real()
            .loc["LATAM", :]
            .reset_coords(drop=True)
        )
        .expand_dims({"REGIONS 35 I": ["LATAM"]}, 0)
        .values
    )
    value.loc[["INDIA"], :, :] = (
        (
            np.maximum(
                initial_households_consumption_propensity_durables()
                .loc["INDIA", :, :]
                .reset_coords(drop=True),
                households_consumption_propensity_durables()
                .loc["INDIA", :, :]
                .reset_coords(drop=True),
            )
            * households_disposable_income_real()
            .loc["INDIA", :]
            .reset_coords(drop=True)
        )
        .expand_dims({"REGIONS 35 I": ["INDIA"]}, 0)
        .values
    )
    return value


@component.add(
    name="aux households consumption non durables real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_propensity_non_durables": 4,
        "households_disposable_income_real": 4,
        "initial_households_consumption_propensity_non_durables": 3,
    },
)
def aux_households_consumption_non_durables_real():
    """
    Households consumption of non durables by household type in real terms.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    )
    except_subs = xr.ones_like(value, dtype=bool)
    except_subs.loc[["LROW"], :] = False
    except_subs.loc[["LATAM"], :] = False
    except_subs.loc[["INDIA"], :] = False
    value.values[except_subs.values] = (
        households_consumption_propensity_non_durables()
        * households_disposable_income_real()
    ).values[except_subs.values]
    value.loc[["LROW"], :] = (
        (
            np.maximum(
                initial_households_consumption_propensity_non_durables()
                .loc["LROW", :]
                .reset_coords(drop=True),
                households_consumption_propensity_non_durables()
                .loc["LROW", :]
                .reset_coords(drop=True),
            )
            * households_disposable_income_real().loc["LROW", :].reset_coords(drop=True)
        )
        .expand_dims({"REGIONS 35 I": ["LROW"]}, 0)
        .values
    )
    value.loc[["LATAM"], :] = (
        (
            np.maximum(
                initial_households_consumption_propensity_non_durables()
                .loc["LATAM", :]
                .reset_coords(drop=True),
                households_consumption_propensity_non_durables()
                .loc["LATAM", :]
                .reset_coords(drop=True),
            )
            * households_disposable_income_real()
            .loc["LATAM", :]
            .reset_coords(drop=True)
        )
        .expand_dims({"REGIONS 35 I": ["LATAM"]}, 0)
        .values
    )
    value.loc[["INDIA"], :] = (
        (
            np.maximum(
                initial_households_consumption_propensity_non_durables()
                .loc["INDIA", :]
                .reset_coords(drop=True),
                households_consumption_propensity_non_durables()
                .loc["INDIA", :]
                .reset_coords(drop=True),
            )
            * households_disposable_income_real()
            .loc["INDIA", :]
            .reset_coords(drop=True)
        )
        .expand_dims({"REGIONS 35 I": ["INDIA"]}, 0)
        .values
    )
    return value


@component.add(
    name="BASE FINAL ENERGY CONSUMPTION HOUSEHOLDS COICOP",
    units="TJ/Year",
    subscripts=["REGIONS 35 I", "COICOP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "initial_final_energy_consumption_households_by_fe_buildings": 6,
        "initial_final_energy_consumption_households_by_fe_transport": 3,
    },
)
def base_final_energy_consumption_households_coicop():
    """
    Housholds final energy consumption (in physical units) by COICOP categoty for the base year (2015).
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "COICOP ENERGY I": _subscript_dict["COICOP ENERGY I"],
        },
        ["REGIONS 35 I", "COICOP ENERGY I"],
    )
    value.loc[:, ["HH ELECTRICITY"]] = (
        (
            initial_final_energy_consumption_households_by_fe_buildings()
            .loc[:, "FE elec"]
            .reset_coords(drop=True)
            + initial_final_energy_consumption_households_by_fe_transport()
            .loc[:, "FE elec"]
            .reset_coords(drop=True)
        )
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH ELECTRICITY"]}, 1)
        .values
    )
    value.loc[:, ["HH GAS"]] = (
        (
            initial_final_energy_consumption_households_by_fe_buildings()
            .loc[:, "FE gas"]
            .reset_coords(drop=True)
            + initial_final_energy_consumption_households_by_fe_transport()
            .loc[:, "FE gas"]
            .reset_coords(drop=True)
        )
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH GAS"]}, 1)
        .values
    )
    value.loc[:, ["HH HEAT"]] = (
        initial_final_energy_consumption_households_by_fe_buildings()
        .loc[:, "FE heat"]
        .reset_coords(drop=True)
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH HEAT"]}, 1)
        .values
    )
    value.loc[:, ["HH LIQUID FUELS"]] = (
        initial_final_energy_consumption_households_by_fe_buildings()
        .loc[:, "FE liquid"]
        .reset_coords(drop=True)
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH LIQUID FUELS"]}, 1)
        .values
    )
    value.loc[:, ["HH SOLID FUELS"]] = (
        (
            initial_final_energy_consumption_households_by_fe_buildings()
            .loc[:, "FE solid fossil"]
            .reset_coords(drop=True)
            + initial_final_energy_consumption_households_by_fe_buildings()
            .loc[:, "FE solid bio"]
            .reset_coords(drop=True)
        )
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH SOLID FUELS"]}, 1)
        .values
    )
    value.loc[:, ["HH FUEL TRANSPORT"]] = (
        initial_final_energy_consumption_households_by_fe_transport()
        .loc[:, "FE liquid"]
        .reset_coords(drop=True)
        .expand_dims({"COICOP ENERGY I": ["HH FUEL TRANSPORT"]}, 1)
        .values
    )
    return value


@component.add(
    name="BETA DURABLES",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"beta_appliances": 1, "beta_housing": 1, "beta_vehicles": 1},
)
def beta_durables():
    """
    Income elasticity of the demand of durables: disaggregated countries
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    )
    value.loc[:, :, ["HH APPLIANCES"]] = (
        beta_appliances()
        .expand_dims({"COICOP DURABLES I": ["HH APPLIANCES"]}, 2)
        .values
    )
    value.loc[:, :, ["HH HOUSING"]] = (
        beta_housing().expand_dims({"COICOP DURABLES I": ["HH HOUSING"]}, 2).values
    )
    value.loc[:, :, ["HH VEHICLES"]] = (
        beta_vehicles().expand_dims({"COICOP DURABLES I": ["HH VEHICLES"]}, 2).values
    )
    return value


@component.add(
    name="CONSTANT AIR",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_air"},
)
def constant_air():
    """
    Constant that captures different region and household type effects for the consumption of air transportation.
    """
    return _ext_constant_constant_air()


_ext_constant_constant_air = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Air",
    "CONST_AIR",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_air",
)


@component.add(
    name="CONSTANT DURABLES",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "constant_appliances": 2,
        "constant_housing": 2,
        "constant_vehicles": 2,
    },
)
def constant_durables():
    """
    Constant that captures different region and household type effects for the consumption of durables.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    )
    value.loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :, ["HH APPLIANCES"]] = (
        constant_appliances()
        .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :]
        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
        .expand_dims({"COICOP DURABLES I": ["HH APPLIANCES"]}, 2)
        .values
    )
    value.loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :, ["HH HOUSING"]] = (
        constant_housing()
        .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :]
        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
        .expand_dims({"COICOP DURABLES I": ["HH HOUSING"]}, 2)
        .values
    )
    value.loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :, ["HH VEHICLES"]] = (
        constant_vehicles()
        .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :]
        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
        .expand_dims({"COICOP DURABLES I": ["HH VEHICLES"]}, 2)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        ["REPRESENTATIVE HOUSEHOLD"],
        ["HH APPLIANCES"],
    ] = (
        constant_appliances()
        .loc[
            _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
            "REPRESENTATIVE HOUSEHOLD",
        ]
        .reset_coords(drop=True)
        .rename({"REGIONS 35 I": "REGIONS NON DISAGGREGATED HH I"})
        .expand_dims({"HOUSEHOLDS I": ["REPRESENTATIVE HOUSEHOLD"]}, 1)
        .expand_dims({"COICOP DURABLES I": ["HH APPLIANCES"]}, 2)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        ["REPRESENTATIVE HOUSEHOLD"],
        ["HH VEHICLES"],
    ] = (
        constant_vehicles()
        .loc[
            _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
            "REPRESENTATIVE HOUSEHOLD",
        ]
        .reset_coords(drop=True)
        .rename({"REGIONS 35 I": "REGIONS NON DISAGGREGATED HH I"})
        .expand_dims({"HOUSEHOLDS I": ["REPRESENTATIVE HOUSEHOLD"]}, 1)
        .expand_dims({"COICOP DURABLES I": ["HH VEHICLES"]}, 2)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        ["REPRESENTATIVE HOUSEHOLD"],
        ["HH HOUSING"],
    ] = (
        constant_housing()
        .loc[
            _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
            "REPRESENTATIVE HOUSEHOLD",
        ]
        .reset_coords(drop=True)
        .rename({"REGIONS 35 I": "REGIONS NON DISAGGREGATED HH I"})
        .expand_dims({"HOUSEHOLDS I": ["REPRESENTATIVE HOUSEHOLD"]}, 1)
        .expand_dims({"COICOP DURABLES I": ["HH HOUSING"]}, 2)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
        :,
    ] = 0
    return value


@component.add(
    name="CONSTANT ELECTRICITY",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_electricity"},
)
def constant_electricity():
    """
    Constant that captures different region and household type effects for the consumption of electricy.
    """
    return _ext_constant_constant_electricity()


_ext_constant_constant_electricity = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Electricity",
    "CONST_ELECTRICITY",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_electricity",
)


@component.add(
    name="CONSTANT FUEL TRANSP",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_fuel_transp"},
)
def constant_fuel_transp():
    """
    Constant that captures different region and household type effects for the consumption of fuel for transportation.
    """
    return _ext_constant_constant_fuel_transp()


_ext_constant_constant_fuel_transp = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Fuel_transp",
    "CONST_FUEL_TRANSP",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_fuel_transp",
)


@component.add(
    name="CONSTANT GAS",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_gas"},
)
def constant_gas():
    """
    Constant that captures different region and household type effects for the consumption of gas.
    """
    return _ext_constant_constant_gas()


_ext_constant_constant_gas = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Gas",
    "CONST_GAS",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_gas",
)


@component.add(
    name="CONSTANT HEAT",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_heat"},
)
def constant_heat():
    """
    Constant that captures different region and household type effects for the consumption of heat.
    """
    return _ext_constant_constant_heat()


_ext_constant_constant_heat = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Heat",
    "CONST_HEAT",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_heat",
)


@component.add(
    name="CONSTANT LIQUIDS",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_liquids"},
)
def constant_liquids():
    """
    Constant that captures different region and household type effects for the consumption of liquid fuels for heating.
    """
    return _ext_constant_constant_liquids()


_ext_constant_constant_liquids = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Liquids",
    "CONST_LIQUIDS",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_liquids",
)


@component.add(
    name="CONSTANT RAIL",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_rail"},
)
def constant_rail():
    """
    Constant that captures different region and household type effects for the consumption of rail transportation.
    """
    return _ext_constant_constant_rail()


_ext_constant_constant_rail = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Rail",
    "CONST_RAIL",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_rail",
)


@component.add(
    name="CONSTANT ROAD",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_road"},
)
def constant_road():
    """
    Constant that captures different region and household type effects for the consumption road transportation.
    """
    return _ext_constant_constant_road()


_ext_constant_constant_road = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Road",
    "CONST_ROAD",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_road",
)


@component.add(
    name="CONSTANT SEA",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_sea"},
)
def constant_sea():
    """
    Constant that captures different region and household type effects for the consumption of sea transportation.
    """
    return _ext_constant_constant_sea()


_ext_constant_constant_sea = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Sea",
    "CONST_SEA",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_sea",
)


@component.add(
    name="CONSTANT SOLID",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_constant_solid"},
)
def constant_solid():
    """
    Constant that captures different region and household type effects for the consumption of solid fuels.
    """
    return _ext_constant_constant_solid()


_ext_constant_constant_solid = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Const_Solid",
    "CONST_SOLID",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_constant_solid",
)


@component.add(
    name="CONSTANT TRANSPORT ENERGY",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "constant_electricity": 1,
        "constant_air": 1,
        "constant_fuel_transp": 1,
        "constant_gas": 1,
        "constant_heat": 1,
        "constant_liquids": 1,
        "constant_rail": 1,
        "constant_road": 1,
        "constant_sea": 1,
        "constant_solid": 1,
    },
)
def constant_transport_energy():
    """
    Constant that captures different region and household type effects for the consumption of energy and transportation.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    )
    value.loc[:, :, ["HH ELECTRICITY"]] = (
        constant_electricity()
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH ELECTRICITY"]}, 2)
        .values
    )
    value.loc[:, :, ["HH AIR"]] = (
        constant_air().expand_dims({"COICOP I": ["HH AIR"]}, 2).values
    )
    value.loc[:, :, ["HH FUEL TRANSPORT"]] = (
        constant_fuel_transp()
        .expand_dims({"COICOP ENERGY I": ["HH FUEL TRANSPORT"]}, 2)
        .values
    )
    value.loc[:, :, ["HH GAS"]] = (
        constant_gas().expand_dims({"COICOP ENERGY BUILDINGS I": ["HH GAS"]}, 2).values
    )
    value.loc[:, :, ["HH HEAT"]] = (
        constant_heat()
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH HEAT"]}, 2)
        .values
    )
    value.loc[:, :, ["HH LIQUID FUELS"]] = (
        constant_liquids()
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH LIQUID FUELS"]}, 2)
        .values
    )
    value.loc[:, :, ["HH RAILWAY"]] = (
        constant_rail().expand_dims({"COICOP I": ["HH RAILWAY"]}, 2).values
    )
    value.loc[:, :, ["HH ROAD"]] = (
        constant_road().expand_dims({"COICOP I": ["HH ROAD"]}, 2).values
    )
    value.loc[:, :, ["HH MARITIME"]] = (
        constant_sea().expand_dims({"COICOP I": ["HH MARITIME"]}, 2).values
    )
    value.loc[:, :, ["HH SOLID FUELS"]] = (
        constant_solid()
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH SOLID FUELS"]}, 2)
        .values
    )
    return value


@component.add(
    name="consumer price index",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"price_coicop": 1, "consumption_coicop_real": 2},
)
def consumer_price_index():
    """
    Consumer price index.
    """
    return zidz(
        sum(
            price_coicop().rename({"COICOP I": "COICOP I!"})
            * consumption_coicop_real().rename({"COICOP I": "COICOP I!"}),
            dim=["COICOP I!"],
        ),
        sum(
            consumption_coicop_real().rename({"COICOP I": "COICOP MAP I!"}),
            dim=["COICOP MAP I!"],
        ),
    )


@component.add(
    name="consumption COICOP",
    units="Mdollars/Year",
    subscripts=["REGIONS 35 I", "COICOP I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "households_consumption_coicop": 2,
        "unit_conversion_dollars_mdollars": 2,
        "base_number_of_households": 1,
        "number_of_households_by_income_and_type": 1,
    },
)
def consumption_coicop():
    """
    Consumption by category (COICOP classification)
    """
    return if_then_else(
        time() <= 2015,
        lambda: sum(
            households_consumption_coicop().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
            * base_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
            / unit_conversion_dollars_mdollars(),
            dim=["HOUSEHOLDS I!"],
        ),
        lambda: sum(
            households_consumption_coicop().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
            * number_of_households_by_income_and_type().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            / unit_conversion_dollars_mdollars(),
            dim=["HOUSEHOLDS I!"],
        ),
    )


@component.add(
    name="consumption COICOP real",
    units="Mdollars 2015/Year",
    subscripts=["REGIONS 35 I", "COICOP I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "unit_conversion_dollars_2015_mdollars_2015": 2,
        "households_consumption_coicop_real": 2,
        "base_number_of_households": 1,
        "number_of_households_by_income_and_type": 1,
    },
)
def consumption_coicop_real():
    """
    Consumption by category (COICOP classification) in real terms.
    """
    return if_then_else(
        time() <= 2015,
        lambda: sum(
            households_consumption_coicop_real().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * base_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
            / unit_conversion_dollars_2015_mdollars_2015(),
            dim=["HOUSEHOLDS I!"],
        ),
        lambda: sum(
            households_consumption_coicop_real().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * number_of_households_by_income_and_type().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            / unit_conversion_dollars_2015_mdollars_2015(),
            dim=["HOUSEHOLDS I!"],
        ),
    )


@component.add(
    name="delayed households consumption durables real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_households_consumption_durables_real": 1},
    other_deps={
        "_delayfixed_delayed_households_consumption_durables_real": {
            "initial": {"initial_households_consumption_durables_real": 1},
            "step": {"households_consumption_durables_real": 1},
        }
    },
)
def delayed_households_consumption_durables_real():
    """
    Delayed households consumption propensity of durable goods: non smooth
    """
    return _delayfixed_delayed_households_consumption_durables_real()


_delayfixed_delayed_households_consumption_durables_real = DelayFixed(
    lambda: households_consumption_durables_real(),
    lambda: 1,
    lambda: initial_households_consumption_durables_real(),
    time_step,
    "_delayfixed_delayed_households_consumption_durables_real",
)


@component.add(
    name="delayed households consumption non durables real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_households_consumption_non_durables_real": 1},
    other_deps={
        "_delayfixed_delayed_households_consumption_non_durables_real": {
            "initial": {"initial_households_consumption_non_durables_real": 1},
            "step": {"households_consumption_non_durables_real": 1},
        }
    },
)
def delayed_households_consumption_non_durables_real():
    """
    Delayed households consumption propensity of durable goods: non smooth
    """
    return _delayfixed_delayed_households_consumption_non_durables_real()


_delayfixed_delayed_households_consumption_non_durables_real = DelayFixed(
    lambda: households_consumption_non_durables_real(),
    lambda: 1,
    lambda: initial_households_consumption_non_durables_real(),
    time_step,
    "_delayfixed_delayed_households_consumption_non_durables_real",
)


@component.add(
    name="delayed number of households",
    units="households",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_number_of_households": 1},
    other_deps={
        "_delayfixed_delayed_number_of_households": {
            "initial": {"base_number_of_households": 1, "time_step": 1},
            "step": {"number_of_households_by_income_and_type": 1},
        }
    },
)
def delayed_number_of_households():
    """
    Delayed number of housholds
    """
    return _delayfixed_delayed_number_of_households()


_delayfixed_delayed_number_of_households = DelayFixed(
    lambda: number_of_households_by_income_and_type(),
    lambda: time_step(),
    lambda: base_number_of_households(),
    time_step,
    "_delayfixed_delayed_number_of_households",
)


@component.add(
    name="delayed TS consumer price index",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_consumer_price_index": 1},
    other_deps={
        "_delayfixed_delayed_ts_consumer_price_index": {
            "initial": {"initial_delayed_consumer_price_index": 1, "time_step": 1},
            "step": {"consumer_price_index": 1},
        }
    },
)
def delayed_ts_consumer_price_index():
    """
    Delayed (time step) consumer price index.
    """
    return _delayfixed_delayed_ts_consumer_price_index()


_delayfixed_delayed_ts_consumer_price_index = DelayFixed(
    lambda: consumer_price_index(),
    lambda: time_step(),
    lambda: initial_delayed_consumer_price_index(),
    time_step,
    "_delayfixed_delayed_ts_consumer_price_index",
)


@component.add(
    name="delayed TS households consumption COICOP real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_households_consumption_coicop_real": 1},
    other_deps={
        "_delayfixed_delayed_ts_households_consumption_coicop_real": {
            "initial": {
                "initial_households_consumption_coicop": 1,
                "dollars_per_dollars_2015": 1,
                "time_step": 1,
            },
            "step": {"households_consumption_coicop_real": 1},
        }
    },
)
def delayed_ts_households_consumption_coicop_real():
    """
    Delayed households consumption by COICOP category by household type in real terms.
    """
    return _delayfixed_delayed_ts_households_consumption_coicop_real()


_delayfixed_delayed_ts_households_consumption_coicop_real = DelayFixed(
    lambda: households_consumption_coicop_real(),
    lambda: time_step(),
    lambda: initial_households_consumption_coicop() / dollars_per_dollars_2015(),
    time_step,
    "_delayfixed_delayed_ts_households_consumption_coicop_real",
)


@component.add(
    name="delayed TS households disposable income",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_households_disposable_income": 1},
    other_deps={
        "_delayfixed_delayed_ts_households_disposable_income": {
            "initial": {"initial_households_disposable_income": 1, "time_step": 1},
            "step": {"households_disposable_income": 1},
        }
    },
)
def delayed_ts_households_disposable_income():
    """
    Delayed housheolds disposable income by household type
    """
    return _delayfixed_delayed_ts_households_disposable_income()


_delayfixed_delayed_ts_households_disposable_income = DelayFixed(
    lambda: households_disposable_income(),
    lambda: time_step(),
    lambda: initial_households_disposable_income(),
    time_step,
    "_delayfixed_delayed_ts_households_disposable_income",
)


@component.add(
    name="delayed TS households share quaids",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_households_share_quaids": 1},
    other_deps={
        "_delayfixed_delayed_ts_households_share_quaids": {
            "initial": {"initial_delayed_households_share_quaids": 1, "time_step": 1},
            "step": {
                "time": 1,
                "initial_delayed_households_share_quaids": 1,
                "households_share_quaids": 1,
            },
        }
    },
)
def delayed_ts_households_share_quaids():
    """
    Delayed (time spte) Households consumption shares of non-durables calcaulted with a QAIDS model.
    """
    return _delayfixed_delayed_ts_households_share_quaids()


_delayfixed_delayed_ts_households_share_quaids = DelayFixed(
    lambda: if_then_else(
        time() <= 2015,
        lambda: initial_delayed_households_share_quaids(),
        lambda: households_share_quaids(),
    ),
    lambda: time_step(),
    lambda: initial_delayed_households_share_quaids(),
    time_step,
    "_delayfixed_delayed_ts_households_share_quaids",
)


@component.add(
    name="delayed TS labour compensation per household",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_labour_compensation_per_household": 1},
    other_deps={
        "_delayfixed_delayed_ts_labour_compensation_per_household": {
            "initial": {"initial_households_labour_compensation": 1, "time_step": 1},
            "step": {
                "time": 1,
                "initial_households_labour_compensation": 1,
                "households_gross_labour_income": 1,
            },
        }
    },
)
def delayed_ts_labour_compensation_per_household():
    """
    Delayed labour compensation
    """
    return _delayfixed_delayed_ts_labour_compensation_per_household()


_delayfixed_delayed_ts_labour_compensation_per_household = DelayFixed(
    lambda: if_then_else(
        time() <= 2015,
        lambda: initial_households_labour_compensation(),
        lambda: households_gross_labour_income(),
    ),
    lambda: time_step(),
    lambda: initial_households_labour_compensation(),
    time_step,
    "_delayfixed_delayed_ts_labour_compensation_per_household",
)


@component.add(
    name="delayed TS net operating surplus per hh",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_net_operating_surplus_per_hh": 1},
    other_deps={
        "_delayfixed_delayed_ts_net_operating_surplus_per_hh": {
            "initial": {"initial_households_net_operating_surplus": 1, "time_step": 1},
            "step": {
                "time": 1,
                "initial_households_net_operating_surplus": 1,
                "households_net_operating_surplus": 1,
            },
        }
    },
)
def delayed_ts_net_operating_surplus_per_hh():
    """
    Delayed (time step) households net operating surplus
    """
    return _delayfixed_delayed_ts_net_operating_surplus_per_hh()


_delayfixed_delayed_ts_net_operating_surplus_per_hh = DelayFixed(
    lambda: if_then_else(
        time() <= 2015,
        lambda: initial_households_net_operating_surplus(),
        lambda: households_net_operating_surplus(),
    ),
    lambda: time_step(),
    lambda: initial_households_net_operating_surplus(),
    time_step,
    "_delayfixed_delayed_ts_net_operating_surplus_per_hh",
)


@component.add(
    name="delayed TS shares consumption non durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP NON DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"delayed_ts_households_consumption_coicop_real": 2},
)
def delayed_ts_shares_consumption_non_durables():
    """
    Delayesd shares of non durable consumption
    """
    return zidz(
        delayed_ts_households_consumption_coicop_real()
        .loc[:, :, _subscript_dict["COICOP NON DURABLES I"]]
        .rename({"COICOP I": "COICOP NON DURABLES I"}),
        sum(
            delayed_ts_households_consumption_coicop_real()
            .loc[:, :, _subscript_dict["COICOP NON DURABLES MAP I"]]
            .rename({"COICOP I": "COICOP NON DURABLES MAP I!"}),
            dim=["COICOP NON DURABLES MAP I!"],
        ).expand_dims(
            {"COICOP NON DURABLES I": _subscript_dict["COICOP NON DURABLES I"]}, 2
        ),
    )


@component.add(
    name="delayed TS shares consumption transportation",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSPORT I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"delayed_ts_households_consumption_coicop_real": 2},
)
def delayed_ts_shares_consumption_transportation():
    """
    Delayed shares of consumption of transportation
    """
    return zidz(
        delayed_ts_households_consumption_coicop_real()
        .loc[:, :, _subscript_dict["COICOP TRANSPORT I"]]
        .rename({"COICOP I": "COICOP TRANSPORT I"}),
        sum(
            delayed_ts_households_consumption_coicop_real()
            .loc[:, :, _subscript_dict["COICOP TRANSPORT I"]]
            .rename({"COICOP I": "COICOP TRANSPORT I!"}),
            dim=["COICOP TRANSPORT I!"],
        ).expand_dims({"COICOP TRANSPORT I": _subscript_dict["COICOP TRANSPORT I"]}, 2),
    )


@component.add(
    name="delayed TS social benefits per household",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_social_benefits_per_household": 1},
    other_deps={
        "_delayfixed_delayed_ts_social_benefits_per_household": {
            "initial": {"initial_households_social_benefits": 1, "time_step": 1},
            "step": {
                "time": 1,
                "initial_households_social_benefits": 1,
                "households_social_benefits": 1,
            },
        }
    },
)
def delayed_ts_social_benefits_per_household():
    """
    Delayed social benefits per household
    """
    return _delayfixed_delayed_ts_social_benefits_per_household()


_delayfixed_delayed_ts_social_benefits_per_household = DelayFixed(
    lambda: if_then_else(
        time() <= 2015,
        lambda: initial_households_social_benefits(),
        lambda: households_social_benefits(),
    ),
    lambda: time_step(),
    lambda: initial_households_social_benefits(),
    time_step,
    "_delayfixed_delayed_ts_social_benefits_per_household",
)


@component.add(
    name="delayed TS taxable income",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_taxable_income": 1},
    other_deps={
        "_delayfixed_delayed_ts_taxable_income": {
            "initial": {"taxable_income": 1, "time_step": 1},
            "step": {"time": 1, "taxable_income": 2},
        }
    },
)
def delayed_ts_taxable_income():
    """
    Delayed taxable income.
    """
    return _delayfixed_delayed_ts_taxable_income()


_delayfixed_delayed_ts_taxable_income = DelayFixed(
    lambda: if_then_else(
        time() <= 2015, lambda: taxable_income(), lambda: taxable_income()
    ),
    lambda: time_step(),
    lambda: taxable_income(),
    time_step,
    "_delayfixed_delayed_ts_taxable_income",
)


@component.add(
    name="delayed TS total households consumption COICOP",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="DelayFixed",
    depends_on={"_delayfixed_delayed_ts_total_households_consumption_coicop": 1},
    other_deps={
        "_delayfixed_delayed_ts_total_households_consumption_coicop": {
            "initial": {"time_step": 1},
            "step": {"total_households_consumption_coicop": 1},
        }
    },
)
def delayed_ts_total_households_consumption_coicop():
    """
    Delayes households consumption by household type.
    """
    return _delayfixed_delayed_ts_total_households_consumption_coicop()


_delayfixed_delayed_ts_total_households_consumption_coicop = DelayFixed(
    lambda: total_households_consumption_coicop(),
    lambda: time_step(),
    lambda: xr.DataArray(
        0,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    ),
    time_step,
    "_delayfixed_delayed_ts_total_households_consumption_coicop",
)


@component.add(
    name="desired transport demand",
    units="km*person",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "transport_demand_by_household_type": 1,
        "number_of_households_by_income_and_type": 1,
    },
)
def desired_transport_demand():
    """
    Desired transport demand
    """
    return (
        transport_demand_by_household_type() * number_of_households_by_income_and_type()
    )


@component.add(
    name="disposable income",
    units="Mdollars/Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income": 1,
        "number_of_households_by_income_and_type": 1,
        "unit_conversion_dollars_mdollars": 1,
    },
)
def disposable_income():
    """
    Disposable income
    """
    return sum(
        households_disposable_income().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
        * number_of_households_by_income_and_type().rename(
            {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
        )
        / unit_conversion_dollars_mdollars(),
        dim=["HOUSEHOLDS I!"],
    )


@component.add(
    name="disposable income real",
    units="Mdollars 2015/Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income_real": 1,
        "number_of_households_by_income_and_type": 1,
        "unit_conversion_dollars_2015_mdollars_2015": 1,
    },
)
def disposable_income_real():
    """
    Disposable income real
    """
    return sum(
        households_disposable_income_real().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
        * number_of_households_by_income_and_type().rename(
            {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
        )
        / unit_conversion_dollars_2015_mdollars_2015(),
        dim=["HOUSEHOLDS I!"],
    )


@component.add(
    name="dynamic beta durables",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"time": 1, "beta_durables": 2, "dynamic_beta_durables_non_adjusted": 2},
)
def dynamic_beta_durables():
    """
    Dynamic income elasticity of the demand of durables.
    """
    return if_then_else(
        time() <= 2015,
        lambda: beta_durables(),
        lambda: if_then_else(
            dynamic_beta_durables_non_adjusted() == 0,
            lambda: beta_durables(),
            lambda: dynamic_beta_durables_non_adjusted(),
        ),
    )


@component.add(
    name="dynamic beta durables non adjusted",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income_real_12_types": 420,
        "income_intervals_by_households": 420,
        "beta_durables": 301,
    },
)
def dynamic_beta_durables_non_adjusted():
    """
    Dynamic income elasticity of the demand of durables.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: beta_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: beta_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: beta_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        ["REPRESENTATIVE HOUSEHOLD"],
        :,
    ] = (
        beta_durables()
        .loc[
            _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
            "REPRESENTATIVE HOUSEHOLD",
            :,
        ]
        .reset_coords(drop=True)
        .rename({"REGIONS 35 I": "REGIONS NON DISAGGREGATED HH I"})
        .expand_dims({"HOUSEHOLDS I": ["REPRESENTATIVE HOUSEHOLD"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
        :,
    ] = 0
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["REPRESENTATIVE HOUSEHOLD"], :
    ] = 0
    return value


@component.add(
    name="dynamic beta non durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "beta_non_durables": 2,
        "dynamic_beta_non_durables_non_adjusted": 2,
    },
)
def dynamic_beta_non_durables():
    """
    Dynamic income elasticity of the demand of durables.
    """
    return if_then_else(
        time() <= 2015,
        lambda: beta_non_durables(),
        lambda: if_then_else(
            dynamic_beta_non_durables_non_adjusted() == 0,
            lambda: beta_non_durables(),
            lambda: dynamic_beta_non_durables_non_adjusted(),
        ),
    )


@component.add(
    name="dynamic beta non durables non adjusted",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income_real_12_types": 420,
        "income_intervals_by_households": 420,
        "beta_non_durables": 301,
    },
)
def dynamic_beta_non_durables_non_adjusted():
    """
    Dynamic income elasticity of the demand of non durables.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: beta_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: beta_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: beta_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: beta_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"], ["REPRESENTATIVE HOUSEHOLD"]
    ] = (
        beta_non_durables()
        .loc[
            _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
            "REPRESENTATIVE HOUSEHOLD",
        ]
        .reset_coords(drop=True)
        .rename({"REGIONS 35 I": "REGIONS NON DISAGGREGATED HH I"})
        .expand_dims({"HOUSEHOLDS I": ["REPRESENTATIVE HOUSEHOLD"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
    ] = 0
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["REPRESENTATIVE HOUSEHOLD"]
    ] = 0
    return value


@component.add(
    name="dynamic constant durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "constant_durables": 2,
        "dynamic_constant_durables_non_adjusted": 2,
    },
)
def dynamic_constant_durables():
    """
    Dynamic constant that captures different region and household type effects for the consumption of durables.
    """
    return if_then_else(
        time() <= 2015,
        lambda: constant_durables(),
        lambda: if_then_else(
            dynamic_constant_durables_non_adjusted() == 0,
            lambda: constant_durables(),
            lambda: dynamic_constant_durables_non_adjusted(),
        ),
    )


@component.add(
    name="dynamic constant durables non adjusted",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income_real_12_types": 420,
        "income_intervals_by_households": 420,
        "constant_durables": 300,
        "dynamic_constant_durables_non_disaggregated_countries": 1,
    },
)
def dynamic_constant_durables_non_adjusted():
    """
    Dynamic constant that captures different region and household type effects for the consumption of durables.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE COUPLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 DENSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 DENSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE SINGLE", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 DENSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE COUPLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE COUPLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE OTHER"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE OTHER", :
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE OTHERWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHERWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE SINGLE"], :
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLE",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE SINGLEWCHILDREN"],
        :,
    ] = (
        if_then_else(
            (
                households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                < income_intervals_by_households()
                .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                .reset_coords(drop=True)
            ).expand_dims(
                {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
            ),
            lambda: constant_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLEWCHILDREN",
                :,
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                ),
                lambda: constant_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    :,
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ).expand_dims(
                        {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 1
                    ),
                    lambda: constant_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        :,
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ).expand_dims(
                            {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]},
                            1,
                        ),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            :,
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        ["REPRESENTATIVE HOUSEHOLD"],
        :,
    ] = (
        dynamic_constant_durables_non_disaggregated_countries()
        .expand_dims({"HOUSEHOLDS I": ["REPRESENTATIVE HOUSEHOLD"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
        :,
    ] = 0
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["REPRESENTATIVE HOUSEHOLD"], :
    ] = 0
    return value


@component.add(
    name="dynamic constant durables non disaggregated countries",
    units="DMNL",
    subscripts=["REGIONS NON DISAGGREGATED HH I", "COICOP DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "alpha_durables_non_disaggregated_countries": 1,
        "households_disposable_income_real": 1,
        "gamma_durables_non_disaggregated_countries": 1,
        "maximum_constant_durables_non_disaggregated_countries": 1,
    },
)
def dynamic_constant_durables_non_disaggregated_countries():
    """
    Dynamic constant that captures different region and household type effects for the consumption of durables: non disaggregated countries.
    """
    return np.minimum(
        alpha_durables_non_disaggregated_countries()
        + gamma_durables_non_disaggregated_countries()
        * households_disposable_income_real()
        .loc[
            _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
            "REPRESENTATIVE HOUSEHOLD",
        ]
        .reset_coords(drop=True)
        .rename({"REGIONS 35 I": "REGIONS NON DISAGGREGATED HH I"}),
        maximum_constant_durables_non_disaggregated_countries(),
    )


@component.add(
    name="dynamic constant non durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "constant_non_durables": 2,
        "dynamic_constant_non_durables_non_adjusted": 2,
    },
)
def dynamic_constant_non_durables():
    """
    Dynamic constant that captures different region and household type effects for the consumption of non durables: non disaggregated countries.
    """
    return if_then_else(
        time() <= 2015,
        lambda: constant_non_durables(),
        lambda: if_then_else(
            dynamic_constant_non_durables_non_adjusted() == 0,
            lambda: constant_non_durables(),
            lambda: dynamic_constant_non_durables_non_adjusted(),
        ),
    )


@component.add(
    name="dynamic constant non durables non adjusted",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income_real_12_types": 420,
        "income_intervals_by_households": 420,
        "constant_non_durables": 300,
        "dynamic_constant_non_durables_non_disaggregated_countries": 1,
    },
)
def dynamic_constant_non_durables_non_adjusted():
    """
    Dynamic constant that captures different region and household type effects for the consumption of non durables.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLE",
                "DENSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLE",
                        "DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                            "DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLE",
                                "DENSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE COUPLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLEWCHILDREN",
                "DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE COUPLEWCHILDREN",
                        "DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                            "DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE COUPLEWCHILDREN",
                                "DENSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHER",
                "DENSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHER",
                        "DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE OTHER"
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                            "DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHER",
                                "DENSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHERWCHILDREN",
                "DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE OTHERWCHILDREN",
                        "DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                            "DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE OTHERWCHILDREN",
                                "DENSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLE",
                "DENSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 DENSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLE",
                        "DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                            "DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLE",
                                "DENSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME1 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME2 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME3 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME4 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 DENSE SINGLEWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLEWCHILDREN",
                "DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 DENSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 DENSE SINGLEWCHILDREN",
                        "DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                            "DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 DENSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 DENSE SINGLEWCHILDREN",
                                "DENSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "DENSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 DENSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS DENSE I": ["INCOME5 DENSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE COUPLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLE",
                "SPARSE COUPLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE COUPLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLE",
                        "SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                            "SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLE",
                                "SPARSE COUPLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE COUPLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLEWCHILDREN",
                "SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE COUPLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE COUPLEWCHILDREN",
                        "SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                            "SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE COUPLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE COUPLEWCHILDREN",
                                "SPARSE COUPLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE COUPLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE COUPLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE COUPLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE OTHER"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHER",
                "SPARSE OTHER",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE OTHER"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHER",
                        "SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                            "SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHER",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHER",
                                "SPARSE OTHER",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHER", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHER",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHER"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE OTHERWCHILDREN"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHERWCHILDREN",
                "SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE OTHERWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE OTHERWCHILDREN",
                        "SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                            "SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE OTHERWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE OTHERWCHILDREN",
                                "SPARSE OTHERWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE OTHERWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE OTHERWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE OTHERWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME1 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME1 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME2 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME2 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME3 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME3 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME4 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME4 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["INCOME5 SPARSE SINGLE"]
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLE",
                "SPARSE SINGLE",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], "INCOME5 SPARSE SINGLE"]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLE",
                        "SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                            "SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLE",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLE",
                                "SPARSE SINGLE",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLE", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLE",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLE"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME1 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME1 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME1 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME1 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME1 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME1 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME2 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME2 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME2 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME2 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME2 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME2 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME3 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME3 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME3 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME3 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME3 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME4 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME4 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME4 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME4 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME4 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"],
        ["INCOME5 SPARSE SINGLEWCHILDREN"],
    ] = (
        if_then_else(
            households_disposable_income_real_12_types()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLEWCHILDREN",
                "SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            < income_intervals_by_households()
            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
            .reset_coords(drop=True),
            lambda: constant_non_durables()
            .loc[
                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                "INCOME5 SPARSE SINGLEWCHILDREN",
            ]
            .reset_coords(drop=True)
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: if_then_else(
                np.logical_and(
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    >= income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 1"]
                    .reset_coords(drop=True),
                    households_disposable_income_real_12_types()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME5 SPARSE SINGLEWCHILDREN",
                        "SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                    < income_intervals_by_households()
                    .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                    .reset_coords(drop=True),
                ),
                lambda: constant_non_durables()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                lambda: if_then_else(
                    np.logical_and(
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        >= income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 2"]
                        .reset_coords(drop=True),
                        households_disposable_income_real_12_types()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                            "SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                        < income_intervals_by_households()
                        .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                        .reset_coords(drop=True),
                    ),
                    lambda: constant_non_durables()
                    .loc[
                        _subscript_dict["REGIONS DISAGGREGATED HH I"],
                        "INCOME3 SPARSE SINGLEWCHILDREN",
                    ]
                    .reset_coords(drop=True)
                    .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    lambda: if_then_else(
                        np.logical_and(
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            >= income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 3"]
                            .reset_coords(drop=True),
                            households_disposable_income_real_12_types()
                            .loc[
                                _subscript_dict["REGIONS DISAGGREGATED HH I"],
                                "INCOME5 SPARSE SINGLEWCHILDREN",
                                "SPARSE SINGLEWCHILDREN",
                            ]
                            .reset_coords(drop=True)
                            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                            < income_intervals_by_households()
                            .loc[:, "SPARSE SINGLEWCHILDREN", "INCOME INTERVAL 4"]
                            .reset_coords(drop=True),
                        ),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME4 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                        lambda: constant_non_durables()
                        .loc[
                            _subscript_dict["REGIONS DISAGGREGATED HH I"],
                            "INCOME5 SPARSE SINGLEWCHILDREN",
                        ]
                        .reset_coords(drop=True)
                        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
                    ),
                ),
            ),
        )
        .expand_dims({"HOUSEHOLDS EU27 I": ["INCOME5 SPARSE SINGLEWCHILDREN"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"], ["REPRESENTATIVE HOUSEHOLD"]
    ] = (
        dynamic_constant_non_durables_non_disaggregated_countries()
        .expand_dims({"HOUSEHOLDS I": ["REPRESENTATIVE HOUSEHOLD"]}, 1)
        .values
    )
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
    ] = 0
    value.loc[
        _subscript_dict["REGIONS DISAGGREGATED HH I"], ["REPRESENTATIVE HOUSEHOLD"]
    ] = 0
    return value


@component.add(
    name="dynamic constant non durables non disaggregated countries",
    units="DMNL",
    subscripts=["REGIONS NON DISAGGREGATED HH I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "alpha_non_durables_non_disaggregated_countries": 1,
        "households_disposable_income_real": 1,
        "gamma_non_durables_non_disaggregated_countries": 1,
        "maximum_constant_non_durables_non_disaggregated_countries": 1,
    },
)
def dynamic_constant_non_durables_non_disaggregated_countries():
    """
    Dynamic constant that captures different region and household type effects for the consumption of non durables: non disaggregated countries.
    """
    return np.minimum(
        alpha_non_durables_non_disaggregated_countries()
        + gamma_non_durables_non_disaggregated_countries()
        * households_disposable_income_real()
        .loc[
            _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
            "REPRESENTATIVE HOUSEHOLD",
        ]
        .reset_coords(drop=True)
        .rename({"REGIONS 35 I": "REGIONS NON DISAGGREGATED HH I"}),
        maximum_constant_non_durables_non_disaggregated_countries(),
    )


@component.add(
    name="energy consumption private transport COICOP physical units",
    units="EJ/Year",
    subscripts=["REGIONS 36 I", "HOUSEHOLDS I", "COICOP ENERGY I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={"energy_consumption_private_passenger_transport_by_mode": 6},
)
def energy_consumption_private_transport_coicop_physical_units():
    """
    Energy consumption for private trasnport in COICOP classsification, physical units
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 36 I": _subscript_dict["REGIONS 36 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP ENERGY I": _subscript_dict["COICOP ENERGY I"],
        },
        ["REGIONS 36 I", "HOUSEHOLDS I", "COICOP ENERGY I"],
    )
    value.loc[_subscript_dict["REGIONS 35 I"], :, ["HH GAS"]] = (
        sum(
            energy_consumption_private_passenger_transport_by_mode()
            .loc[:, "FE gas", :, :]
            .reset_coords(drop=True)
            .rename({"PRIVATE TRANSPORT I": "PRIVATE TRANSPORT I!"}),
            dim=["PRIVATE TRANSPORT I!"],
        )
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH GAS"]}, 2)
        .values
    )
    value.loc[_subscript_dict["REGIONS 35 I"], :, ["HH HEAT"]] = (
        sum(
            energy_consumption_private_passenger_transport_by_mode()
            .loc[:, "FE heat", :, :]
            .reset_coords(drop=True)
            .rename({"PRIVATE TRANSPORT I": "PRIVATE TRANSPORT I!"}),
            dim=["PRIVATE TRANSPORT I!"],
        )
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH HEAT"]}, 2)
        .values
    )
    value.loc[_subscript_dict["REGIONS 35 I"], :, ["HH SOLID FUELS"]] = (
        (
            sum(
                energy_consumption_private_passenger_transport_by_mode()
                .loc[:, "FE solid bio", :, :]
                .reset_coords(drop=True)
                .rename({"PRIVATE TRANSPORT I": "PRIVATE TRANSPORT I!"}),
                dim=["PRIVATE TRANSPORT I!"],
            )
            + sum(
                energy_consumption_private_passenger_transport_by_mode()
                .loc[:, "FE solid fossil", :, :]
                .reset_coords(drop=True)
                .rename({"PRIVATE TRANSPORT I": "PRIVATE TRANSPORT I!"}),
                dim=["PRIVATE TRANSPORT I!"],
            )
        )
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH SOLID FUELS"]}, 2)
        .values
    )
    value.loc[_subscript_dict["REGIONS 35 I"], :, ["HH FUEL TRANSPORT"]] = (
        sum(
            energy_consumption_private_passenger_transport_by_mode()
            .loc[:, "FE liquid", :, :]
            .reset_coords(drop=True)
            .rename({"PRIVATE TRANSPORT I": "PRIVATE TRANSPORT I!"}),
            dim=["PRIVATE TRANSPORT I!"],
        )
        .expand_dims({"COICOP ENERGY I": ["HH FUEL TRANSPORT"]}, 2)
        .values
    )
    value.loc[:, :, ["HH LIQUID FUELS"]] = 0
    value.loc[_subscript_dict["REGIONS 35 I"], :, ["HH ELECTRICITY"]] = (
        sum(
            energy_consumption_private_passenger_transport_by_mode()
            .loc[:, "FE elec", :, :]
            .reset_coords(drop=True)
            .rename({"PRIVATE TRANSPORT I": "PRIVATE TRANSPORT I!"}),
            dim=["PRIVATE TRANSPORT I!"],
        )
        .expand_dims({"COICOP ENERGY BUILDINGS I": ["HH ELECTRICITY"]}, 2)
        .values
    )
    return value


@component.add(
    name="final energy consumption buildings and transport",
    units="TJ/Year",
    subscripts=["REGIONS 35 I", "COICOP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "base_final_energy_consumption_households_coicop": 1,
        "imv_final_energy_consumption_transport_households": 1,
        "imv_final_energy_consumption_buildings_households": 1,
    },
)
def final_energy_consumption_buildings_and_transport():
    """
    Households final energy consumption in physical untis calcaulted top-down in COICOP classification
    """
    return if_then_else(
        time() <= 2015,
        lambda: base_final_energy_consumption_households_coicop(),
        lambda: imv_final_energy_consumption_buildings_households()
        + imv_final_energy_consumption_transport_households(),
    )


@component.add(
    name="households consumer price index",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_consumption_shares_real": 1, "price_coicop": 1},
)
def households_consumer_price_index():
    """
    Households consumer price index by household type.
    """
    return sum(
        households_consumption_shares_real().rename({"COICOP I": "COICOP I!"})
        * price_coicop().rename({"COICOP I": "COICOP I!"}),
        dim=["COICOP I!"],
    )


@component.add(
    name="households consumer price index non durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "price_coicop": 1,
        "households_consumption_shares_non_durables_real": 1,
    },
)
def households_consumer_price_index_non_durables():
    """
    Households consumer price index of non durables by household type
    """
    return sum(
        price_coicop()
        .loc[:, _subscript_dict["COICOP NON DURABLES I"]]
        .rename({"COICOP I": "COICOP NON DURABLES I!"})
        * households_consumption_shares_non_durables_real()
        .rename({"COICOP NON DURABLES I": "COICOP NON DURABLES I!"})
        .transpose("REGIONS 35 I", "COICOP NON DURABLES I!", "HOUSEHOLDS I"),
        dim=["COICOP NON DURABLES I!"],
    )


@component.add(
    name="households consumption COICOP",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_coicop_real": 1,
        "price_coicop": 1,
        "price_transformation": 1,
        "dollars_per_dollars_2015": 1,
    },
)
def households_consumption_coicop():
    """
    Households consumption by COICOP category by household type.
    """
    return (
        households_consumption_coicop_real()
        * (price_coicop() / price_transformation())
        * dollars_per_dollars_2015()
    )


@component.add(
    name="households consumption COICOP real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "adjustment_factor_households_consumption_to_avoid_negative_assets": 1,
        "households_consumption_coicop_real_non_adjusted": 1,
        "households_disposable_income_real": 1,
        "households_consumption_shares_real": 1,
    },
)
def households_consumption_coicop_real():
    """
    Households consumption by COICOP category by household type in real terms.
    """
    return if_then_else(
        (
            adjustment_factor_households_consumption_to_avoid_negative_assets() >= 1
        ).expand_dims({"COICOP I": _subscript_dict["COICOP I"]}, 2),
        lambda: households_consumption_coicop_real_non_adjusted(),
        lambda: households_consumption_shares_real()
        * households_disposable_income_real(),
    )


@component.add(
    name="households consumption COICOP real non adjusted",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_share_quaids_real": 1,
        "households_consumption_non_durable_non_energy_real": 1,
        "households_consumption_transport_and_buildings_energy_real": 1,
        "households_consumption_durables_real": 1,
    },
)
def households_consumption_coicop_real_non_adjusted():
    """
    Households consumption by COICOP category by household type in real terms.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP I": _subscript_dict["COICOP I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP I"],
    )
    value.loc[:, :, _subscript_dict["QUAIDS I"]] = (
        households_share_quaids_real()
        * households_consumption_non_durable_non_energy_real()
    ).values
    value.loc[:, :, _subscript_dict["COICOP TRANSP ENERGY I"]] = (
        households_consumption_transport_and_buildings_energy_real().values
    )
    value.loc[:, :, _subscript_dict["COICOP DURABLES I"]] = (
        households_consumption_durables_real().values
    )
    return value


@component.add(
    name="households consumption durables real",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "select_limit_annual_growth_consumption_durables_sp": 1,
        "time": 1,
        "initial_limit_annual_growth_consumption_durables_sp": 1,
        "limit_annual_growth_consumption_durables_sp": 2,
        "annual_growth_households_consumption_durables_real": 2,
        "delayed_households_consumption_durables_real": 2,
    },
)
def households_consumption_durables_real():
    """
    Households consumption propensity of durable goods
    """
    return if_then_else(
        np.logical_and(
            (select_limit_annual_growth_consumption_durables_sp() == 1),
            np.logical_and(
                (time() >= initial_limit_annual_growth_consumption_durables_sp()),
                annual_growth_households_consumption_durables_real()
                > limit_annual_growth_consumption_durables_sp(),
            ),
        ),
        lambda: delayed_households_consumption_durables_real()
        * (1 + limit_annual_growth_consumption_durables_sp()),
        lambda: delayed_households_consumption_durables_real()
        * (1 + annual_growth_households_consumption_durables_real()),
    )


@component.add(
    name="households consumption energy buildings",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_eco_hh_buildings_energy_bottom_up": 1,
        "switch_economy": 1,
        "households_consumption_energy_buildings_top_down": 1,
        "households_consumption_energy_buildings_bottom_up": 1,
    },
)
def households_consumption_energy_buildings():
    """
    Households energy consumption in buildings by household type.
    """
    return if_then_else(
        np.logical_or(
            switch_eco_hh_buildings_energy_bottom_up() == 0, switch_economy() == 0
        ),
        lambda: households_consumption_energy_buildings_top_down(),
        lambda: households_consumption_energy_buildings_bottom_up()
        .loc[_subscript_dict["REGIONS 35 I"], :, :]
        .rename({"REGIONS 36 I": "REGIONS 35 I"}),
    )


@component.add(
    name="households consumption energy buildings bottom up",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 36 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={"initial_households_consumption_coicop": 1},
)
def households_consumption_energy_buildings_bottom_up():
    """
    Households energy consumption in buildings by household type
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 36 I": _subscript_dict["REGIONS 36 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
        },
        ["REGIONS 36 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    )
    value.loc[
        _subscript_dict["REGIONS 35 I"], :, _subscript_dict["COICOP ENERGY BUILDINGS I"]
    ] = (
        initial_households_consumption_coicop()
        .loc[:, :, _subscript_dict["COICOP ENERGY BUILDINGS I"]]
        .rename({"COICOP I": "COICOP ENERGY BUILDINGS I"})
        .values
    )
    value.loc[:, :, _subscript_dict["COICOP TRANSPORT I"]] = 0
    return value


@component.add(
    name="households consumption energy buildings real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_energy_buildings": 1,
        "price_coicop": 1,
        "price_transformation": 1,
        "dollars_per_dollars_2015": 1,
    },
)
def households_consumption_energy_buildings_real():
    """
    Households energy consumption in buildings by household type in real terms.
    """
    return (
        zidz(
            households_consumption_energy_buildings(),
            (
                price_coicop()
                .loc[:, _subscript_dict["COICOP TRANSP ENERGY I"]]
                .rename({"COICOP I": "COICOP TRANSP ENERGY I"})
                / price_transformation()
            ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 1),
        )
        / dollars_per_dollars_2015()
    )


@component.add(
    name="households consumption energy buildings top down",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_consumption_transport_energy_top_down": 1},
)
def households_consumption_energy_buildings_top_down():
    """
    Households energy consumption in buildings calculted top-down
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    )
    value.loc[:, :, _subscript_dict["COICOP ENERGY BUILDINGS I"]] = (
        households_consumption_transport_energy_top_down()
        .loc[:, :, _subscript_dict["COICOP ENERGY BUILDINGS I"]]
        .rename({"COICOP TRANSP ENERGY I": "COICOP ENERGY BUILDINGS I"})
        .values
    )
    value.loc[:, :, _subscript_dict["COICOP TRANSPORT I"]] = 0
    return value


@component.add(
    name="households consumption energy transport bottom up",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_energy_transport_consumption_coicop": 1,
        "implicit_price_public_households_energy_transport_consumption": 1,
        "price_coicop": 1,
        "price_transformation": 1,
    },
)
def households_consumption_energy_transport_bottom_up():
    """
    Households electricity consumption for transportation calculated bottom-up households_energy_transport_consumption_COICOP[REGIONS 35 I,HOUSEHOLDS I,COICOP ENERGY I] *IMPLICIT_PRICE_ENERGY_TRANSPORT_COICOP[REGIONS 35 I,HOUSEHOLDS I,COICOP ENERGY I] *(price_COICOP[REGIONS 35 I,COICOP ENERGY I]/PRICE_TRANSFORMATION)
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    )
    value.loc[:, :, _subscript_dict["COICOP ENERGY I"]] = (
        households_energy_transport_consumption_coicop()
        * implicit_price_public_households_energy_transport_consumption()
        * (
            price_coicop()
            .loc[:, _subscript_dict["COICOP ENERGY I"]]
            .rename({"COICOP I": "COICOP ENERGY I"})
            / price_transformation()
        )
    ).values
    value.loc[:, :, _subscript_dict["COICOP TRANSPORT EXC FUEL I"]] = 0
    return value


@component.add(
    name="households consumption non durable non energy",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_non_durables": 2,
        "households_consumption_transport_and_buildings_energy": 2,
    },
)
def households_consumption_non_durable_non_energy():
    """
    Households total consumption non durable non energy by household type.
    """
    return if_then_else(
        households_consumption_non_durables()
        - sum(
            households_consumption_transport_and_buildings_energy().rename(
                {"COICOP TRANSP ENERGY I": "COICOP TRANSP ENERGY I!"}
            ),
            dim=["COICOP TRANSP ENERGY I!"],
        )
        < 0,
        lambda: xr.DataArray(
            0,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I"],
        ),
        lambda: households_consumption_non_durables()
        - sum(
            households_consumption_transport_and_buildings_energy().rename(
                {"COICOP TRANSP ENERGY I": "COICOP TRANSP ENERGY I!"}
            ),
            dim=["COICOP TRANSP ENERGY I!"],
        ),
    )


@component.add(
    name="households consumption non durable non energy real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_non_durables_real": 2,
        "households_consumption_transport_and_buildings_energy_real": 2,
    },
)
def households_consumption_non_durable_non_energy_real():
    """
    Households consumption of non durables non energy by household type in real terms.
    """
    return if_then_else(
        households_consumption_non_durables_real()
        - sum(
            households_consumption_transport_and_buildings_energy_real().rename(
                {"COICOP TRANSP ENERGY I": "COICOP TRANSP ENERGY I!"}
            ),
            dim=["COICOP TRANSP ENERGY I!"],
        )
        < 0,
        lambda: xr.DataArray(
            0,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I"],
        ),
        lambda: households_consumption_non_durables_real()
        - sum(
            households_consumption_transport_and_buildings_energy_real().rename(
                {"COICOP TRANSP ENERGY I": "COICOP TRANSP ENERGY I!"}
            ),
            dim=["COICOP TRANSP ENERGY I!"],
        ),
    )


@component.add(
    name="households consumption non durables",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_non_durables_real": 1,
        "households_consumer_price_index_non_durables": 1,
        "price_transformation": 1,
        "dollars_per_dollars_2015": 1,
    },
)
def households_consumption_non_durables():
    """
    Households consumption of non durables by household type.
    """
    return (
        households_consumption_non_durables_real()
        * households_consumer_price_index_non_durables()
        / price_transformation()
        * dollars_per_dollars_2015()
    )


@component.add(
    name="households consumption non durables real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "select_limit_annual_growth_consumption_non_durables_sp": 1,
        "initial_limit_annual_growth_consumption_non_durables_sp": 1,
        "time": 1,
        "limit_annual_growth_consumption_non_durables_sp": 2,
        "annual_growth_households_consumption_non_durables_real": 2,
        "delayed_households_consumption_non_durables_real": 2,
    },
)
def households_consumption_non_durables_real():
    """
    Households consumption of non durables by household type in real terms.
    """
    return if_then_else(
        np.logical_and(
            (select_limit_annual_growth_consumption_non_durables_sp() == 1),
            np.logical_and(
                (time() >= initial_limit_annual_growth_consumption_non_durables_sp()),
                annual_growth_households_consumption_non_durables_real()
                > limit_annual_growth_consumption_non_durables_sp(),
            ),
        ),
        lambda: delayed_households_consumption_non_durables_real()
        * (1 + limit_annual_growth_consumption_non_durables_sp()),
        lambda: delayed_households_consumption_non_durables_real()
        * (1 + annual_growth_households_consumption_non_durables_real()),
    )


@component.add(
    name="households consumption propensity durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Stateful",
    comp_subtype="Smooth",
    depends_on={"_smooth_households_consumption_propensity_durables": 1},
    other_deps={
        "_smooth_households_consumption_propensity_durables": {
            "initial": {"households_consumption_propensity_durables_non_smooth": 1},
            "step": {"households_consumption_propensity_durables_non_smooth": 1},
        }
    },
)
def households_consumption_propensity_durables():
    """
    Households consumption propensity of durable goods: smooth
    """
    return _smooth_households_consumption_propensity_durables()


_smooth_households_consumption_propensity_durables = Smooth(
    lambda: households_consumption_propensity_durables_non_smooth(),
    lambda: xr.DataArray(
        10,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    ),
    lambda: households_consumption_propensity_durables_non_smooth(),
    lambda: 1,
    "_smooth_households_consumption_propensity_durables",
)


@component.add(
    name="households consumption propensity durables non smooth",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "dynamic_constant_durables": 2,
        "households_disposable_income_real": 2,
        "dynamic_beta_durables": 1,
    },
)
def households_consumption_propensity_durables_non_smooth():
    """
    Households consumption propensity of durable goods: non smooth
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    )
    except_subs = xr.ones_like(value, dtype=bool)
    except_subs.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
        :,
    ] = False
    value.values[except_subs.values] = if_then_else(
        dynamic_constant_durables() == 0,
        lambda: xr.DataArray(
            0,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
        ),
        lambda: np.exp(
            dynamic_constant_durables()
            + if_then_else(
                (households_disposable_income_real() <= 0).expand_dims(
                    {"COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"]}, 2
                ),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        "COICOP DURABLES I": _subscript_dict["COICOP DURABLES I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
                ),
                lambda: dynamic_beta_durables()
                * np.log(households_disposable_income_real()),
            )
        ),
    ).values[except_subs.values]
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
        :,
    ] = 0
    return value


@component.add(
    name="households consumption propensity non durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="Smooth",
    depends_on={"_smooth_households_consumption_propensity_non_durables": 1},
    other_deps={
        "_smooth_households_consumption_propensity_non_durables": {
            "initial": {"households_consumption_propensity_non_durables_non_smooth": 1},
            "step": {"households_consumption_propensity_non_durables_non_smooth": 1},
        }
    },
)
def households_consumption_propensity_non_durables():
    """
    Households consumption propensity of non durable goods
    """
    return _smooth_households_consumption_propensity_non_durables()


_smooth_households_consumption_propensity_non_durables = Smooth(
    lambda: households_consumption_propensity_non_durables_non_smooth(),
    lambda: xr.DataArray(
        10,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    ),
    lambda: households_consumption_propensity_non_durables_non_smooth(),
    lambda: 1,
    "_smooth_households_consumption_propensity_non_durables",
)


@component.add(
    name="households consumption propensity non durables non smooth",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "dynamic_constant_non_durables": 2,
        "households_disposable_income_real": 2,
        "dynamic_beta_non_durables": 1,
    },
)
def households_consumption_propensity_non_durables_non_smooth():
    """
    Households consumption propensity of non durable goods: non smooth
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    )
    except_subs = xr.ones_like(value, dtype=bool)
    except_subs.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
    ] = False
    value.values[except_subs.values] = if_then_else(
        dynamic_constant_non_durables() == 0,
        lambda: xr.DataArray(
            0,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I"],
        ),
        lambda: np.exp(
            dynamic_constant_non_durables()
            + if_then_else(
                households_disposable_income_real() <= 0,
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I"],
                ),
                lambda: dynamic_beta_non_durables()
                * np.log(households_disposable_income_real()),
            )
        ),
    ).values[except_subs.values]
    value.loc[
        _subscript_dict["REGIONS NON DISAGGREGATED HH I"],
        _subscript_dict["HOUSEHOLDS EU27 I"],
    ] = 0
    return value


@component.add(
    name="households consumption public transport bottom up",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 36 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_public_households_transport_demand_coicop": 1,
        "implicit_price_public_transport_households": 1,
        "price_coicop": 1,
        "price_transformation": 1,
    },
)
def households_consumption_public_transport_bottom_up():
    """
    Households consumption of public transport calculated bottom-up
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 36 I": _subscript_dict["REGIONS 36 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
        },
        ["REGIONS 36 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    )
    value.loc[
        _subscript_dict["REGIONS 35 I"],
        :,
        _subscript_dict["COICOP TRANSPORT EXC FUEL I"],
    ] = (
        households_public_households_transport_demand_coicop()
        * implicit_price_public_transport_households()
        * (
            price_coicop()
            .loc[:, _subscript_dict["COICOP TRANSPORT EXC FUEL I"]]
            .rename({"COICOP I": "COICOP TRANSPORT EXC FUEL I"})
            / price_transformation()
        )
    ).values
    value.loc[:, :, _subscript_dict["COICOP ENERGY I"]] = 0
    return value


@component.add(
    name="households consumption shares non durables real",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP NON DURABLES I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"delayed_ts_households_consumption_coicop_real": 2},
)
def households_consumption_shares_non_durables_real():
    """
    Households consumption shares non durables by COICOP category by household type in real terms.
    """
    return zidz(
        delayed_ts_households_consumption_coicop_real()
        .loc[:, :, _subscript_dict["COICOP NON DURABLES I"]]
        .rename({"COICOP I": "COICOP NON DURABLES I"}),
        sum(
            delayed_ts_households_consumption_coicop_real()
            .loc[:, :, _subscript_dict["COICOP NON DURABLES MAP I"]]
            .rename({"COICOP I": "COICOP NON DURABLES MAP I!"}),
            dim=["COICOP NON DURABLES MAP I!"],
        ).expand_dims(
            {"COICOP NON DURABLES I": _subscript_dict["COICOP NON DURABLES I"]}, 2
        ),
    )


@component.add(
    name="households consumption shares real",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"delayed_ts_households_consumption_coicop_real": 2},
)
def households_consumption_shares_real():
    """
    Households consumption shares by COICOP category by household type in real terms.
    """
    return zidz(
        delayed_ts_households_consumption_coicop_real(),
        sum(
            delayed_ts_households_consumption_coicop_real().rename(
                {"COICOP I": "COICOP MAP I!"}
            ),
            dim=["COICOP MAP I!"],
        ).expand_dims({"COICOP I": _subscript_dict["COICOP I"]}, 2),
    )


@component.add(
    name="households consumption transport",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_eco_hh_transport_energy_bottom_up": 2,
        "switch_economy": 2,
        "households_consumption_transport_top_down": 2,
        "households_consumption_transport_bottom_up": 3,
    },
)
def households_consumption_transport():
    """
    Housholds consumption of transportaion (public and fuel) by household type.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    )
    except_subs = xr.ones_like(value, dtype=bool)
    except_subs.loc[:, :, ["HH MARITIME"]] = False
    value.values[except_subs.values] = if_then_else(
        np.logical_or(
            switch_eco_hh_transport_energy_bottom_up() == 0, switch_economy() == 0
        ),
        lambda: households_consumption_transport_top_down(),
        lambda: households_consumption_transport_bottom_up(),
    ).values[except_subs.values]
    value.loc[:, :, ["HH MARITIME"]] = (
        if_then_else(
            np.logical_or(
                switch_eco_hh_transport_energy_bottom_up() == 0,
                np.logical_or(
                    switch_economy() == 0,
                    households_consumption_transport_bottom_up()
                    .loc[:, :, "HH MARITIME"]
                    .reset_coords(drop=True)
                    == 0,
                ),
            ),
            lambda: households_consumption_transport_top_down()
            .loc[:, :, "HH MARITIME"]
            .reset_coords(drop=True),
            lambda: households_consumption_transport_bottom_up()
            .loc[:, :, "HH MARITIME"]
            .reset_coords(drop=True),
        )
        .expand_dims({"COICOP I": ["HH MARITIME"]}, 2)
        .values
    )
    return value


@component.add(
    name="households consumption transport and buildings energy",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "initial_households_consumption_coicop": 1,
        "households_consumption_energy_buildings": 1,
        "households_consumption_transport": 1,
    },
)
def households_consumption_transport_and_buildings_energy():
    """
    Households consumption of transportation (public and fuel) and energy in buildings by household type.
    """
    return if_then_else(
        time() <= 2015,
        lambda: initial_households_consumption_coicop()
        .loc[:, :, _subscript_dict["COICOP TRANSP ENERGY I"]]
        .rename({"COICOP I": "COICOP TRANSP ENERGY I"}),
        lambda: households_consumption_energy_buildings()
        + households_consumption_transport(),
    )


@component.add(
    name="households consumption transport and buildings energy real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "initial_households_consumption_coicop": 1,
        "dollars_per_dollars_2015": 1,
        "households_consumption_transport_real": 1,
        "households_consumption_energy_buildings_real": 1,
    },
)
def households_consumption_transport_and_buildings_energy_real():
    """
    Households consumption of transportation (public and fuel) and energy in buildings by household type in real terms.
    """
    return if_then_else(
        time() <= 2015,
        lambda: initial_households_consumption_coicop()
        .loc[:, :, _subscript_dict["COICOP TRANSP ENERGY I"]]
        .rename({"COICOP I": "COICOP TRANSP ENERGY I"})
        / dollars_per_dollars_2015(),
        lambda: households_consumption_energy_buildings_real()
        + households_consumption_transport_real(),
    )


@component.add(
    name="households consumption transport bottom up",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_energy_transport_bottom_up": 1,
        "households_consumption_public_transport_bottom_up": 1,
    },
)
def households_consumption_transport_bottom_up():
    """
    Households consumption of transportation (public and fuel) by household type calculated bottom-up
    """
    return (
        households_consumption_energy_transport_bottom_up()
        + households_consumption_public_transport_bottom_up()
        .loc[_subscript_dict["REGIONS 35 I"], :, :]
        .rename({"REGIONS 36 I": "REGIONS 35 I"})
    )


@component.add(
    name="households consumption transport energy top down",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "switch_eco_hh_transport_energy_bottom_up": 2,
        "households_consumption_transport_energy_top_down_non_adjusted": 3,
        "initial_households_consumption_transport_bottom_up": 2,
        "households_consumption_transport_energy_top_down_adjustment_factor": 2,
        "switch_economy": 1,
    },
)
def households_consumption_transport_energy_top_down():
    """
    Households energy consumption for transportation calculated top-down
    """
    return if_then_else(
        np.logical_and(time() <= 2015, switch_eco_hh_transport_energy_bottom_up() == 1),
        lambda: households_consumption_transport_energy_top_down_non_adjusted()
        - initial_households_consumption_transport_bottom_up(),
        lambda: if_then_else(
            np.logical_or(
                switch_eco_hh_transport_energy_bottom_up() == 0, switch_economy() == 0
            ),
            lambda: np.maximum(
                0,
                households_consumption_transport_energy_top_down_non_adjusted()
                * households_consumption_transport_energy_top_down_adjustment_factor(),
            ),
            lambda: np.maximum(
                0,
                households_consumption_transport_energy_top_down_non_adjusted()
                * households_consumption_transport_energy_top_down_adjustment_factor()
                - initial_households_consumption_transport_bottom_up(),
            ),
        ),
    )


@component.add(
    name="households consumption transport energy top down adjustment factor",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="Smooth",
    depends_on={
        "_smooth_households_consumption_transport_energy_top_down_adjustment_factor": 1
    },
    other_deps={
        "_smooth_households_consumption_transport_energy_top_down_adjustment_factor": {
            "initial": {
                "select_limit_consumption_energy_over_total_non_durables_sp": 1,
                "limit_consumption_energy_over_total_non_durables": 2,
                "ratio_household_consumpion_transport_energy_to_total_non_durables": 2,
            },
            "step": {
                "select_limit_consumption_energy_over_total_non_durables_sp": 1,
                "limit_consumption_energy_over_total_non_durables": 2,
                "ratio_household_consumpion_transport_energy_to_total_non_durables": 2,
            },
        }
    },
)
def households_consumption_transport_energy_top_down_adjustment_factor():
    """
    Adjustment factor for consumption of energy and transportation. Total consumption of energy and transportation is restricted to be lower than x% of total consumption of non durables.
    """
    return _smooth_households_consumption_transport_energy_top_down_adjustment_factor()


_smooth_households_consumption_transport_energy_top_down_adjustment_factor = Smooth(
    lambda: if_then_else(
        np.logical_and(
            select_limit_consumption_energy_over_total_non_durables_sp() == 1,
            ratio_household_consumpion_transport_energy_to_total_non_durables()
            > limit_consumption_energy_over_total_non_durables(),
        ),
        lambda: zidz(
            xr.DataArray(
                limit_consumption_energy_over_total_non_durables(),
                {
                    "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                    "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                },
                ["REGIONS 35 I", "HOUSEHOLDS I"],
            ),
            ratio_household_consumpion_transport_energy_to_total_non_durables(),
        ),
        lambda: xr.DataArray(
            1,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I"],
        ),
    ),
    lambda: xr.DataArray(
        2,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    ),
    lambda: if_then_else(
        np.logical_and(
            select_limit_consumption_energy_over_total_non_durables_sp() == 1,
            ratio_household_consumpion_transport_energy_to_total_non_durables()
            > limit_consumption_energy_over_total_non_durables(),
        ),
        lambda: zidz(
            xr.DataArray(
                limit_consumption_energy_over_total_non_durables(),
                {
                    "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                    "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                },
                ["REGIONS 35 I", "HOUSEHOLDS I"],
            ),
            ratio_household_consumpion_transport_energy_to_total_non_durables(),
        ),
        lambda: xr.DataArray(
            1,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I"],
        ),
    ),
    lambda: 1,
    "_smooth_households_consumption_transport_energy_top_down_adjustment_factor",
)


@component.add(
    name="households consumption transport energy top down non adjusted",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income": 2,
        "price_coicop": 2,
        "price_transformation": 2,
        "constant_transport_energy": 1,
        "transport_and_energy_elasticities": 2,
    },
)
def households_consumption_transport_energy_top_down_non_adjusted():
    """
    Households energy consumption for transportation calculated top-down
    """
    return if_then_else(
        np.logical_or(
            (households_disposable_income() == 0),
            (
                zidz(
                    price_coicop()
                    .loc[:, _subscript_dict["COICOP TRANSP ENERGY I"]]
                    .rename({"COICOP I": "COICOP TRANSP ENERGY I"}),
                    price_transformation(),
                )
                == 0
            ),
        ),
        lambda: xr.DataArray(
            0,
            {
                "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
            },
            ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
        ),
        lambda: np.exp(
            constant_transport_energy()
            + (
                transport_and_energy_elasticities()
                .loc[:, "INCOME ELASTICITY"]
                .reset_coords(drop=True)
                * np.log(households_disposable_income())
            ).transpose("REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I")
            + (
                transport_and_energy_elasticities()
                .loc[:, "PRICE ELASTICITY"]
                .reset_coords(drop=True)
                * np.log(
                    zidz(
                        price_coicop()
                        .loc[:, _subscript_dict["COICOP TRANSP ENERGY I"]]
                        .rename({"COICOP I": "COICOP TRANSP ENERGY I"}),
                        price_transformation(),
                    )
                ).transpose("COICOP TRANSP ENERGY I", "REGIONS 35 I")
            ).transpose("REGIONS 35 I", "COICOP TRANSP ENERGY I")
        ),
    )


@component.add(
    name="households consumption transport real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_consumption_transport": 1,
        "price_coicop": 1,
        "price_transformation": 1,
        "dollars_per_dollars_2015": 1,
    },
)
def households_consumption_transport_real():
    """
    Housholds consumption of transportation (public and fuel) by household type in real terms.
    """
    return (
        zidz(
            households_consumption_transport(),
            (
                price_coicop()
                .loc[:, _subscript_dict["COICOP TRANSP ENERGY I"]]
                .rename({"COICOP I": "COICOP TRANSP ENERGY I"})
                / price_transformation()
            ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 1),
        )
        / dollars_per_dollars_2015()
    )


@component.add(
    name="households consumption transport top down",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "select_lockdown_effect_on_households_transport_sp": 1,
        "time": 1,
        "year_lockdown_effect_on_households_transport_sp": 1,
        "households_consumption_transport_energy_top_down": 2,
        "lockdown_households_transport_demand_variation_sp": 1,
    },
)
def households_consumption_transport_top_down():
    """
    Households transport consumption calculted top-down.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSP ENERGY I": _subscript_dict["COICOP TRANSP ENERGY I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    )
    value.loc[:, :, _subscript_dict["COICOP TRANSPORT I"]] = if_then_else(
        np.logical_and(
            select_lockdown_effect_on_households_transport_sp() == 1,
            time() == year_lockdown_effect_on_households_transport_sp(),
        ),
        lambda: (1 + lockdown_households_transport_demand_variation_sp())
        * households_consumption_transport_energy_top_down()
        .loc[:, :, _subscript_dict["COICOP TRANSPORT I"]]
        .rename({"COICOP TRANSP ENERGY I": "COICOP TRANSPORT I"}),
        lambda: households_consumption_transport_energy_top_down()
        .loc[:, :, _subscript_dict["COICOP TRANSPORT I"]]
        .rename({"COICOP TRANSP ENERGY I": "COICOP TRANSPORT I"}),
    ).values
    value.loc[:, :, _subscript_dict["COICOP ENERGY BUILDINGS I"]] = 0
    return value


@component.add(
    name="households disposable income",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_economy": 1,
        "switch_fin2eco": 1,
        "time": 1,
        "households_income_tax": 2,
        "initial_households_property_income_paid": 1,
        "initial_households_property_income_received": 1,
        "household_basic_income": 2,
        "households_other_transfers_received": 2,
        "households_net_operating_surplus": 2,
        "households_social_benefits": 2,
        "households_net_labour_income": 2,
        "households_other_transfers_paid": 2,
        "households_wealth_tax": 2,
        "households_property_income_paid": 1,
        "households_property_income_received": 1,
    },
)
def households_disposable_income():
    """
    Households disposable income by household type.
    """
    return if_then_else(
        np.logical_or(
            switch_economy() == 0, np.logical_or(switch_fin2eco() == 0, time() <= 2015)
        ),
        lambda: households_net_labour_income()
        + initial_households_property_income_received()
        + households_net_operating_surplus()
        - initial_households_property_income_paid()
        + households_social_benefits()
        + households_other_transfers_received()
        - households_other_transfers_paid()
        - households_income_tax()
        - households_wealth_tax()
        + household_basic_income(),
        lambda: np.maximum(
            0,
            households_net_labour_income()
            + households_property_income_received()
            + households_net_operating_surplus()
            - households_property_income_paid()
            + households_social_benefits()
            + households_other_transfers_received()
            - households_other_transfers_paid()
            - households_income_tax()
            - households_wealth_tax()
            + household_basic_income(),
        ),
    )


@component.add(
    name="households disposable income real",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income": 1,
        "households_consumer_price_index": 1,
        "price_transformation": 1,
        "dollars_per_dollars_2015": 1,
    },
)
def households_disposable_income_real():
    """
    Households disposable income by household type in real terms.
    """
    return (
        zidz(
            households_disposable_income(),
            households_consumer_price_index() / price_transformation(),
        )
        / dollars_per_dollars_2015()
    )


@component.add(
    name="households disposable income real 12 types",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "HOUSEHOLDS DEMOGRAPHY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_correspondance_12_to_60": 1,
        "households_disposable_income_real": 1,
    },
)
def households_disposable_income_real_12_types():
    """
    Households disposable income by household type (12 types: 6 composition x 2 rural/urban) in real terms
    """
    return (
        households_correspondance_12_to_60()
        * households_disposable_income_real().transpose("HOUSEHOLDS I", "REGIONS 35 I")
    ).transpose("REGIONS 35 I", "HOUSEHOLDS I", "HOUSEHOLDS DEMOGRAPHY I")


@component.add(
    name="households disposable income real per capita",
    units="dollars 2015/(Year*person)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income_real": 1,
        "people_per_household_by_income_and_type": 1,
    },
)
def households_disposable_income_real_per_capita():
    """
    Households disposable income per capita by household type in real terms
    """
    return zidz(
        households_disposable_income_real(), people_per_household_by_income_and_type()
    )


@component.add(
    name="households energy transport consumption COICOP",
    units="TJ/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "energy_consumption_private_transport_coicop_physical_units": 1,
        "number_of_households_by_income_and_type": 1,
        "unit_conversion_tj_ej": 1,
    },
)
def households_energy_transport_consumption_coicop():
    """
    Household energy consumption for transportation by household type in physical untis.
    """
    return (
        zidz(
            energy_consumption_private_transport_coicop_physical_units()
            .loc[_subscript_dict["REGIONS 35 I"], :, :]
            .rename({"REGIONS 36 I": "REGIONS 35 I"}),
            number_of_households_by_income_and_type().expand_dims(
                {"COICOP ENERGY I": _subscript_dict["COICOP ENERGY I"]}, 2
            ),
        )
        * unit_conversion_tj_ej()
    )


@component.add(
    name="households gross labour income",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_eco_households": 1,
        "time": 1,
        "initial_households_labour_compensation": 1,
        "delayed_ts_labour_compensation_per_household": 1,
        "adjustment_factor_labour_compensation": 1,
    },
)
def households_gross_labour_income():
    """
    Gross labour income by household type
    """
    return if_then_else(
        np.logical_or(switch_eco_households() == 0, time() <= 2015),
        lambda: initial_households_labour_compensation(),
        lambda: adjustment_factor_labour_compensation()
        * delayed_ts_labour_compensation_per_household(),
    )


@component.add(
    name="households gross savings",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_disposable_income": 1,
        "total_households_consumption_coicop": 1,
    },
)
def households_gross_savings():
    """
    Net amount that households have available to purchase financial assets. If it is negative, they will have to liquidate assets or acquire liabilities.
    """
    return households_disposable_income() - total_households_consumption_coicop()


@component.add(
    name="households income tax",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_income_tax_exc_ghg_tax_reductions": 1,
        "ghg_tax_revenues_used_to_reduce_income_tax": 1,
        "number_of_households_by_income_and_type": 1,
        "unit_conversion_dollars_mdollars": 1,
        "shares_households_income_tax": 1,
    },
)
def households_income_tax():
    """
    Households income tax by household type
    """
    return households_income_tax_exc_ghg_tax_reductions() - zidz(
        ghg_tax_revenues_used_to_reduce_income_tax()
        * unit_conversion_dollars_mdollars()
        * shares_households_income_tax(),
        number_of_households_by_income_and_type(),
    )


@component.add(
    name="households income tax exc GHG tax reductions",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_tax_rate_income": 1, "delayed_ts_taxable_income": 1},
)
def households_income_tax_exc_ghg_tax_reductions():
    """
    Households income tax by household type exculding income tax reductions
    """
    return households_tax_rate_income() * delayed_ts_taxable_income()


@component.add(
    name="households net labour income",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_gross_labour_income": 1, "households_social_security": 1},
)
def households_net_labour_income():
    """
    Households net labour income by household type.
    """
    return households_gross_labour_income() - households_social_security()


@component.add(
    name="households net operating surplus",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_eco_households": 1,
        "time": 1,
        "initial_households_net_operating_surplus": 1,
        "adjustment_factor_net_operating_surplus": 1,
        "delayed_ts_net_operating_surplus_per_hh": 1,
    },
)
def households_net_operating_surplus():
    """
    Households net operating surplus by household type
    """
    return if_then_else(
        np.logical_or(switch_eco_households() == 0, time() <= 2015),
        lambda: initial_households_net_operating_surplus(),
        lambda: adjustment_factor_net_operating_surplus()
        * delayed_ts_net_operating_surplus_per_hh(),
    )


@component.add(
    name="households other transfers paid",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_households_other_transfers_paid"},
)
def households_other_transfers_paid():
    """
    Households other transfers paid by household type
    """
    return _ext_constant_households_other_transfers_paid()


_ext_constant_households_other_transfers_paid = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "HH_Other_transfers_paid",
    "OTHER_TRANSFERS_PAID",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_households_other_transfers_paid",
)


@component.add(
    name="households other transfers received",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_households_other_transfers_received"},
)
def households_other_transfers_received():
    """
    Households other transfers received by household type
    """
    return _ext_constant_households_other_transfers_received()


_ext_constant_households_other_transfers_received = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "HH_Other_transfers_rec",
    "OTHER_TRANSFERS_RECEIVED",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_households_other_transfers_received",
)


@component.add(
    name="households public households transport demand COICOP",
    units="(km*person)/households",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSPORT EXC FUEL I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "public_transport_demand_coicop_physical_units": 1,
        "number_of_households_by_income_and_type": 1,
    },
)
def households_public_households_transport_demand_coicop():
    """
    Households consumption of public transport by houshold type in physical units
    """
    return zidz(
        public_transport_demand_coicop_physical_units(),
        number_of_households_by_income_and_type().expand_dims(
            {
                "COICOP TRANSPORT EXC FUEL I": _subscript_dict[
                    "COICOP TRANSPORT EXC FUEL I"
                ]
            },
            2,
        ),
    )


@component.add(
    name="households share quaids",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_share_quaids_non_adjusted": 2},
)
def households_share_quaids():
    """
    Households consumption shares of non-durables calcaulted with a QAIDS model.
    """
    return zidz(
        households_share_quaids_non_adjusted(),
        sum(
            households_share_quaids_non_adjusted().rename(
                {"QUAIDS I": "QUAIDS MAP I!"}
            ),
            dim=["QUAIDS MAP I!"],
        ).expand_dims({"QUAIDS I": _subscript_dict["QUAIDS I"]}, 2),
    )


@component.add(
    name="households share quaids non adjusted",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "constant_quaids": 4,
        "price_coicop": 8,
        "beta_quaids": 4,
        "price_transformation": 16,
        "price_quaids_1": 16,
        "households_consumption_non_durable_non_energy": 16,
        "epsilon_quaids": 4,
        "alpha_quaids": 4,
        "price_quaids_2": 8,
    },
)
def households_share_quaids_non_adjusted():
    """
    Households share of non-durables consumption calcaulted with a QAIDS model.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "QUAIDS I": _subscript_dict["QUAIDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
    )
    except_subs = xr.ones_like(value, dtype=bool)
    except_subs.loc[:, :, ["HH FOOD"]] = False
    value.values[except_subs.values] = np.maximum(
        0.02,
        if_then_else(
            constant_quaids()
            + if_then_else(
                (
                    price_coicop()
                    .loc[:, _subscript_dict["QUAIDS I"]]
                    .rename({"COICOP I": "QUAIDS I"})
                    <= 0
                ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 2),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "QUAIDS I": _subscript_dict["QUAIDS I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "QUAIDS I", "HOUSEHOLDS I"],
                ),
                lambda: sum(
                    beta_quaids().rename({"QUAIDS MAP I": "QUAIDS MAP I!"})
                    * np.log(
                        price_coicop()
                        .loc[:, _subscript_dict["QUAIDS MAP I"]]
                        .rename({"COICOP I": "QUAIDS MAP I!"})
                        / price_transformation()
                    ),
                    dim=["QUAIDS MAP I!"],
                ).transpose("REGIONS 35 I", "QUAIDS I", "HOUSEHOLDS I"),
            ).transpose("REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I")
            + if_then_else(
                np.logical_or(
                    price_quaids_1() <= 0,
                    households_consumption_non_durable_non_energy() <= 0,
                ).expand_dims({"QUAIDS I": _subscript_dict["QUAIDS I"]}, 2),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        "QUAIDS I": _subscript_dict["QUAIDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
                ),
                lambda: epsilon_quaids()
                * np.log(
                    households_consumption_non_durable_non_energy()
                    / (price_quaids_1() / price_transformation())
                ),
            )
            + if_then_else(
                np.logical_or(
                    price_quaids_2() <= 0,
                    np.logical_or(
                        price_quaids_1() <= 0,
                        households_consumption_non_durable_non_energy() <= 0,
                    ),
                ).expand_dims({"QUAIDS I": _subscript_dict["QUAIDS I"]}, 2),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        "QUAIDS I": _subscript_dict["QUAIDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
                ),
                lambda: (alpha_quaids() / (price_quaids_2() / price_transformation()))
                * (
                    np.log(
                        households_consumption_non_durable_non_energy()
                        / (price_quaids_1() / price_transformation())
                    )
                    ** 2
                ),
            )
            <= 0,
            lambda: xr.DataArray(
                0,
                {
                    "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                    "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    "QUAIDS I": _subscript_dict["QUAIDS I"],
                },
                ["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
            ),
            lambda: constant_quaids()
            + if_then_else(
                (
                    price_coicop()
                    .loc[:, _subscript_dict["QUAIDS I"]]
                    .rename({"COICOP I": "QUAIDS I"})
                    <= 0
                ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 2),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "QUAIDS I": _subscript_dict["QUAIDS I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "QUAIDS I", "HOUSEHOLDS I"],
                ),
                lambda: sum(
                    beta_quaids().rename({"QUAIDS MAP I": "QUAIDS MAP I!"})
                    * np.log(
                        price_coicop()
                        .loc[:, _subscript_dict["QUAIDS MAP I"]]
                        .rename({"COICOP I": "QUAIDS MAP I!"})
                        / price_transformation()
                    ),
                    dim=["QUAIDS MAP I!"],
                ).transpose("REGIONS 35 I", "QUAIDS I", "HOUSEHOLDS I"),
            ).transpose("REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I")
            + if_then_else(
                np.logical_or(
                    price_quaids_1() <= 0,
                    households_consumption_non_durable_non_energy() <= 0,
                ).expand_dims({"QUAIDS I": _subscript_dict["QUAIDS I"]}, 2),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        "QUAIDS I": _subscript_dict["QUAIDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
                ),
                lambda: epsilon_quaids()
                * np.log(
                    households_consumption_non_durable_non_energy()
                    / (price_quaids_1() / price_transformation())
                ),
            )
            + if_then_else(
                np.logical_or(
                    price_quaids_2() <= 0,
                    np.logical_or(
                        price_quaids_1() <= 0,
                        households_consumption_non_durable_non_energy() <= 0,
                    ),
                ).expand_dims({"QUAIDS I": _subscript_dict["QUAIDS I"]}, 2),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        "QUAIDS I": _subscript_dict["QUAIDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
                ),
                lambda: (alpha_quaids() / (price_quaids_2() / price_transformation()))
                * (
                    np.log(
                        households_consumption_non_durable_non_energy()
                        / (price_quaids_1() / price_transformation())
                    )
                    ** 2
                ),
            ),
        ),
    ).values[except_subs.values]
    value.loc[:, :, ["HH FOOD"]] = (
        np.maximum(
            0.04,
            if_then_else(
                constant_quaids().loc[:, :, "HH FOOD"].reset_coords(drop=True)
                + if_then_else(
                    (
                        price_coicop().loc[:, "HH FOOD"].reset_coords(drop=True) <= 0
                    ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 1),
                    lambda: xr.DataArray(
                        0,
                        {
                            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        },
                        ["REGIONS 35 I", "HOUSEHOLDS I"],
                    ),
                    lambda: sum(
                        beta_quaids()
                        .loc[:, :, "HH FOOD", :]
                        .reset_coords(drop=True)
                        .rename({"QUAIDS MAP I": "QUAIDS MAP I!"})
                        * np.log(
                            price_coicop()
                            .loc[:, _subscript_dict["QUAIDS MAP I"]]
                            .rename({"COICOP I": "QUAIDS MAP I!"})
                            / price_transformation()
                        ),
                        dim=["QUAIDS MAP I!"],
                    ),
                )
                + if_then_else(
                    np.logical_or(
                        price_quaids_1() <= 0,
                        households_consumption_non_durable_non_energy() <= 0,
                    ),
                    lambda: xr.DataArray(
                        0,
                        {
                            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        },
                        ["REGIONS 35 I", "HOUSEHOLDS I"],
                    ),
                    lambda: epsilon_quaids()
                    .loc[:, :, "HH FOOD"]
                    .reset_coords(drop=True)
                    * np.log(
                        households_consumption_non_durable_non_energy()
                        / (price_quaids_1() / price_transformation())
                    ),
                )
                + if_then_else(
                    np.logical_or(
                        price_quaids_2() <= 0,
                        np.logical_or(
                            price_quaids_1() <= 0,
                            households_consumption_non_durable_non_energy() <= 0,
                        ),
                    ),
                    lambda: xr.DataArray(
                        0,
                        {
                            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        },
                        ["REGIONS 35 I", "HOUSEHOLDS I"],
                    ),
                    lambda: (
                        alpha_quaids().loc[:, :, "HH FOOD"].reset_coords(drop=True)
                        / (price_quaids_2() / price_transformation())
                    )
                    * np.log(
                        households_consumption_non_durable_non_energy()
                        / (price_quaids_1() / price_transformation())
                    )
                    ** 2,
                )
                <= 0,
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I"],
                ),
                lambda: constant_quaids().loc[:, :, "HH FOOD"].reset_coords(drop=True)
                + if_then_else(
                    (
                        price_coicop().loc[:, "HH FOOD"].reset_coords(drop=True) <= 0
                    ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 1),
                    lambda: xr.DataArray(
                        0,
                        {
                            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        },
                        ["REGIONS 35 I", "HOUSEHOLDS I"],
                    ),
                    lambda: sum(
                        beta_quaids()
                        .loc[:, :, "HH FOOD", :]
                        .reset_coords(drop=True)
                        .rename({"QUAIDS MAP I": "QUAIDS MAP I!"})
                        * np.log(
                            price_coicop()
                            .loc[:, _subscript_dict["QUAIDS MAP I"]]
                            .rename({"COICOP I": "QUAIDS MAP I!"})
                            / price_transformation()
                        ),
                        dim=["QUAIDS MAP I!"],
                    ),
                )
                + if_then_else(
                    np.logical_or(
                        price_quaids_1() <= 0,
                        households_consumption_non_durable_non_energy() <= 0,
                    ),
                    lambda: xr.DataArray(
                        0,
                        {
                            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        },
                        ["REGIONS 35 I", "HOUSEHOLDS I"],
                    ),
                    lambda: epsilon_quaids()
                    .loc[:, :, "HH FOOD"]
                    .reset_coords(drop=True)
                    * np.log(
                        households_consumption_non_durable_non_energy()
                        / (price_quaids_1() / price_transformation())
                    ),
                )
                + if_then_else(
                    np.logical_or(
                        price_quaids_2() <= 0,
                        np.logical_or(
                            price_quaids_1() <= 0,
                            households_consumption_non_durable_non_energy() <= 0,
                        ),
                    ),
                    lambda: xr.DataArray(
                        0,
                        {
                            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                        },
                        ["REGIONS 35 I", "HOUSEHOLDS I"],
                    ),
                    lambda: (
                        alpha_quaids().loc[:, :, "HH FOOD"].reset_coords(drop=True)
                        / (price_quaids_2() / price_transformation())
                    )
                    * np.log(
                        households_consumption_non_durable_non_energy()
                        / (price_quaids_1() / price_transformation())
                    )
                    ** 2,
                ),
            ),
        )
        .expand_dims({"COICOP I": ["HH FOOD"]}, 2)
        .values
    )
    return value


@component.add(
    name="households share quaids real",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "QUAIDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_share_quaids": 2, "price_coicop": 2},
)
def households_share_quaids_real():
    """
    Households consumption shares of non-durables calcaulted with a QAIDS model in real terms.
    """
    return zidz(
        households_share_quaids()
        * price_coicop()
        .loc[:, _subscript_dict["QUAIDS I"]]
        .rename({"COICOP I": "QUAIDS I"}),
        sum(
            households_share_quaids().rename({"QUAIDS I": "QUAIDS MAP I!"})
            * price_coicop()
            .loc[:, _subscript_dict["QUAIDS MAP I"]]
            .rename({"COICOP I": "QUAIDS MAP I!"}),
            dim=["QUAIDS MAP I!"],
        ).expand_dims({"QUAIDS I": _subscript_dict["QUAIDS I"]}, 2),
    )


@component.add(
    name="households shares by income",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "delayed_number_of_households": 2,
        "summation_matrix_hh_shares_by_income_group": 1,
    },
)
def households_shares_by_income():
    """
    Households shares by income in each 12 socio-demographic groups (rural/unrab * 6 type)
    """
    return zidz(
        delayed_number_of_households(),
        sum(
            delayed_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS MAP I!"})
            * summation_matrix_hh_shares_by_income_group()
            .rename({"HOUSEHOLDS MAP I": "HOUSEHOLDS MAP I!"})
            .transpose("HOUSEHOLDS MAP I!", "HOUSEHOLDS I"),
            dim=["HOUSEHOLDS MAP I!"],
        ),
    )


@component.add(
    name="households social benefits",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_eco_households": 1,
        "time": 1,
        "initial_households_social_benefits": 1,
        "adjustment_factor_social_benefits": 1,
        "delayed_ts_social_benefits_per_household": 1,
    },
)
def households_social_benefits():
    """
    Households social benefits by household type.
    """
    return if_then_else(
        np.logical_or(switch_eco_households() == 0, time() <= 2015),
        lambda: initial_households_social_benefits(),
        lambda: adjustment_factor_social_benefits()
        * delayed_ts_social_benefits_per_household(),
    )


@component.add(
    name="households social security",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"tax_rate_social_security": 1, "households_gross_labour_income": 1},
)
def households_social_security():
    """
    Social security contributions by household type
    """
    return tax_rate_social_security() * households_gross_labour_income()


@component.add(
    name="households tax rate income",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "select_tax_rate_income_sp": 1,
        "initial_year_tax_rate_income_sp": 1,
        "time": 1,
        "tax_rate_income_sp": 1,
        "tax_rate_income_default": 1,
    },
)
def households_tax_rate_income():
    """
    Households income tax rate
    """
    return if_then_else(
        np.logical_and(
            select_tax_rate_income_sp() == 1,
            initial_year_tax_rate_income_sp() >= time(),
        ),
        lambda: tax_rate_income_sp(),
        lambda: tax_rate_income_default(),
    )


@component.add(
    name="households tax rate wealth",
    units="DMNL/Year",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "select_tax_rate_wealth_sp": 1,
        "time": 1,
        "initial_year_tax_rate_wealth_sp": 1,
        "tax_rate_wealth_sp": 1,
        "tax_rate_wealth_default": 1,
    },
)
def households_tax_rate_wealth():
    """
    Households wealth tax rate
    """
    return if_then_else(
        np.logical_and(
            select_tax_rate_wealth_sp() == 1,
            initial_year_tax_rate_wealth_sp() >= time(),
        ),
        lambda: tax_rate_wealth_sp(),
        lambda: tax_rate_wealth_default(),
    )


@component.add(
    name="households wealth tax",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_economy": 1,
        "switch_fin2eco": 1,
        "time": 1,
        "initial_households_net_wealth": 1,
        "households_tax_rate_wealth": 2,
        "initial_household_taxes_on_assets_to_finance_basic_income": 1,
        "delayed_ts_households_net_wealth": 1,
        "households_taxes_on_assets_to_finance_basic_income": 1,
    },
)
def households_wealth_tax():
    """
    Households wealth taxes by household type, modularized with initial values when the IF condition is sufficed.
    """
    return if_then_else(
        np.logical_or(
            switch_economy() == 0, np.logical_or(switch_fin2eco() == 0, time() <= 2015)
        ),
        lambda: initial_households_net_wealth() * households_tax_rate_wealth()
        + initial_household_taxes_on_assets_to_finance_basic_income(),
        lambda: delayed_ts_households_net_wealth() * households_tax_rate_wealth()
        + households_taxes_on_assets_to_finance_basic_income(),
    )


@component.add(
    name="IMPLICIT PRICE ENERGY HOUSEHOLDS COICOP",
    units="Mdollars/TJ",
    subscripts=["REGIONS 35 I", "COICOP I"],
    comp_type="Constant, Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "initial_consumption_coicop": 1,
        "base_final_energy_consumption_households_coicop": 1,
    },
)
def implicit_price_energy_households_coicop():
    """
    Implicit prices of energy consumed by housholds by
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "COICOP I": _subscript_dict["COICOP I"],
        },
        ["REGIONS 35 I", "COICOP I"],
    )
    value.loc[:, _subscript_dict["COICOP ENERGY I"]] = zidz(
        initial_consumption_coicop()
        .loc[:, _subscript_dict["COICOP ENERGY I"]]
        .rename({"COICOP I": "COICOP ENERGY I"}),
        base_final_energy_consumption_households_coicop(),
    ).values
    value.loc[:, _subscript_dict["COICOP NON ENERGY I"]] = 0
    return value


@component.add(
    name="IMPLICIT PRICE PUBLIC HOUSEHOLDS ENERGY TRANSPORT CONSUMPTION",
    units="$/TJ",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "implicit_price_energy_households_coicop": 1,
        "unit_conversion_dollars_mdollars": 1,
    },
)
def implicit_price_public_households_energy_transport_consumption():
    """
    Implicit prices for households consumption of energy for transportation
    """
    return (
        implicit_price_energy_households_coicop()
        .loc[:, _subscript_dict["COICOP ENERGY I"]]
        .rename({"COICOP I": "COICOP ENERGY I"})
        * unit_conversion_dollars_mdollars()
    ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 1)


@component.add(
    name="IMPLICIT PRICE PUBLIC TRANSPORT HOUSEHOLDS",
    units="dollars/(Year*person*km)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSPORT EXC FUEL I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "initial_households_consumption_coicop": 1,
        "initial_households_public_transport_demand_coicop": 1,
    },
)
def implicit_price_public_transport_households():
    """
    Implicit prices for households consumption of public transporta
    """
    return zidz(
        initial_households_consumption_coicop()
        .loc[:, :, _subscript_dict["COICOP TRANSPORT EXC FUEL I"]]
        .rename({"COICOP I": "COICOP TRANSPORT EXC FUEL I"}),
        initial_households_public_transport_demand_coicop(),
    )


@component.add(
    name="IMV final energy consumption buildings households",
    units="TJ/Year",
    subscripts=["REGIONS 35 I", "COICOP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "dollars_per_dollars_2015": 2,
        "implicit_price_energy_households_coicop": 2,
        "households_consumption_energy_buildings_real": 2,
        "base_number_of_households": 1,
        "unit_conversion_dollars_mdollars": 2,
        "number_of_households_by_income_and_type": 1,
    },
)
def imv_final_energy_consumption_buildings_households():
    """
    Final energy consumption buildings households. Depending on the value of SWITCH ECO HH BUILDINGS ENERGY BOTTOM UP, this contains data generated in a top-down or bottom-up way.
    """
    return if_then_else(
        time() <= 2015,
        lambda: zidz(
            sum(
                households_consumption_energy_buildings_real()
                .loc[:, :, _subscript_dict["COICOP ENERGY I"]]
                .rename(
                    {
                        "HOUSEHOLDS I": "HOUSEHOLDS I!",
                        "COICOP TRANSP ENERGY I": "COICOP ENERGY I",
                    }
                )
                * dollars_per_dollars_2015()
                * base_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
                / unit_conversion_dollars_mdollars(),
                dim=["HOUSEHOLDS I!"],
            ),
            implicit_price_energy_households_coicop()
            .loc[:, _subscript_dict["COICOP ENERGY I"]]
            .rename({"COICOP I": "COICOP ENERGY I"}),
        ),
        lambda: zidz(
            sum(
                households_consumption_energy_buildings_real()
                .loc[:, :, _subscript_dict["COICOP ENERGY I"]]
                .rename(
                    {
                        "HOUSEHOLDS I": "HOUSEHOLDS I!",
                        "COICOP TRANSP ENERGY I": "COICOP ENERGY I",
                    }
                )
                * dollars_per_dollars_2015()
                * number_of_households_by_income_and_type().rename(
                    {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
                )
                / unit_conversion_dollars_mdollars(),
                dim=["HOUSEHOLDS I!"],
            ),
            implicit_price_energy_households_coicop()
            .loc[:, _subscript_dict["COICOP ENERGY I"]]
            .rename({"COICOP I": "COICOP ENERGY I"}),
        ),
    )


@component.add(
    name="IMV final energy consumption transport households",
    units="TJ/Year",
    subscripts=["REGIONS 35 I", "COICOP ENERGY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "dollars_per_dollars_2015": 2,
        "implicit_price_energy_households_coicop": 2,
        "base_number_of_households": 1,
        "unit_conversion_dollars_mdollars": 2,
        "households_consumption_transport_real": 2,
        "number_of_households_by_income_and_type": 1,
    },
)
def imv_final_energy_consumption_transport_households():
    """
    Final energy consumption transport households. Depending on the value of SWITCH ECO HH TRANSPORT ENERGY BOTTOM UP, this contains data generated in a top-down or bottom-up way.
    """
    return if_then_else(
        time() <= 2015,
        lambda: zidz(
            sum(
                households_consumption_transport_real()
                .loc[:, :, _subscript_dict["COICOP ENERGY I"]]
                .rename(
                    {
                        "HOUSEHOLDS I": "HOUSEHOLDS I!",
                        "COICOP TRANSP ENERGY I": "COICOP ENERGY I",
                    }
                )
                * dollars_per_dollars_2015()
                * base_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"})
                / unit_conversion_dollars_mdollars(),
                dim=["HOUSEHOLDS I!"],
            ),
            implicit_price_energy_households_coicop()
            .loc[:, _subscript_dict["COICOP ENERGY I"]]
            .rename({"COICOP I": "COICOP ENERGY I"}),
        ),
        lambda: zidz(
            sum(
                households_consumption_transport_real()
                .loc[:, :, _subscript_dict["COICOP ENERGY I"]]
                .rename(
                    {
                        "HOUSEHOLDS I": "HOUSEHOLDS I!",
                        "COICOP TRANSP ENERGY I": "COICOP ENERGY I",
                    }
                )
                * dollars_per_dollars_2015()
                * number_of_households_by_income_and_type().rename(
                    {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
                )
                / unit_conversion_dollars_mdollars(),
                dim=["HOUSEHOLDS I!"],
            ),
            implicit_price_energy_households_coicop()
            .loc[:, _subscript_dict["COICOP ENERGY I"]]
            .rename({"COICOP I": "COICOP ENERGY I"}),
        ),
    )


@component.add(
    name="income intervals by households",
    units="dollars 2015/(Year*households)",
    subscripts=[
        "REGIONS DISAGGREGATED HH I",
        "HOUSEHOLDS DEMOGRAPHY I",
        "INCOME INTERVAL I",
    ],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"initial_households_disposable_income_real_12_types": 96},
)
def income_intervals_by_households():
    """
    Intervals of households disposable income by household type (12 types: 6 composition x 2 rural/urban) in real terms
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS DISAGGREGATED HH I": _subscript_dict["REGIONS DISAGGREGATED HH I"],
            "HOUSEHOLDS DEMOGRAPHY I": _subscript_dict["HOUSEHOLDS DEMOGRAPHY I"],
            "INCOME INTERVAL I": _subscript_dict["INCOME INTERVAL I"],
        },
        ["REGIONS DISAGGREGATED HH I", "HOUSEHOLDS DEMOGRAPHY I", "INCOME INTERVAL I"],
    )
    value.loc[:, ["DENSE SINGLE"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["DENSE SINGLE"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["DENSE SINGLE"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["DENSE SINGLE"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE SINGLE",
                    "DENSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["DENSE SINGLEWCHILDREN"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["DENSE SINGLEWCHILDREN"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["DENSE SINGLEWCHILDREN"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["DENSE SINGLEWCHILDREN"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE SINGLEWCHILDREN",
                    "DENSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLE"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLE"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLE"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLE"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE COUPLE",
                    "DENSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLEWCHILDREN"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLEWCHILDREN"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLEWCHILDREN"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["DENSE COUPLEWCHILDREN"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE COUPLEWCHILDREN",
                    "DENSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHER"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHER"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHER"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHER"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE OTHER",
                    "DENSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHERWCHILDREN"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHERWCHILDREN"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHERWCHILDREN"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["DENSE OTHERWCHILDREN"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 DENSE OTHERWCHILDREN",
                    "DENSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["DENSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLE"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLE"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLE"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLE"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE SINGLE",
                    "SPARSE SINGLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLEWCHILDREN"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLEWCHILDREN"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLEWCHILDREN"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE SINGLEWCHILDREN"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE SINGLEWCHILDREN",
                    "SPARSE SINGLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE SINGLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLE"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLE"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLE"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLE"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE COUPLE",
                    "SPARSE COUPLE",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLE"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLEWCHILDREN"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLEWCHILDREN"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLEWCHILDREN"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE COUPLEWCHILDREN"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE COUPLEWCHILDREN",
                    "SPARSE COUPLEWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE COUPLEWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHER"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHER"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHER"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHER"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE OTHER",
                    "SPARSE OTHER",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHER"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHERWCHILDREN"], ["INCOME INTERVAL 1"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME1 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 1"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHERWCHILDREN"], ["INCOME INTERVAL 2"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME2 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 2"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHERWCHILDREN"], ["INCOME INTERVAL 3"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME3 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 3"]}, 2)
        .values
    )
    value.loc[:, ["SPARSE OTHERWCHILDREN"], ["INCOME INTERVAL 4"]] = (
        (
            (
                initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME4 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
                + initial_households_disposable_income_real_12_types()
                .loc[
                    _subscript_dict["REGIONS DISAGGREGATED HH I"],
                    "INCOME5 SPARSE OTHERWCHILDREN",
                    "SPARSE OTHERWCHILDREN",
                ]
                .reset_coords(drop=True)
                .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"})
            )
            / 2
        )
        .expand_dims({"HOUSEHOLDS DEMOGRAPHY I": ["SPARSE OTHERWCHILDREN"]}, 1)
        .expand_dims({"INCOME INTERVAL I": ["INCOME INTERVAL 4"]}, 2)
        .values
    )
    return value


@component.add(
    name="INITIAL CONSUMPTION COICOP",
    units="Mdollars/Year",
    subscripts=["REGIONS 35 I", "COICOP I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_initial_consumption_coicop"},
)
def initial_consumption_coicop():
    """
    Initial total consumption by COICOP category.
    """
    return _ext_constant_initial_consumption_coicop()


_ext_constant_initial_consumption_coicop = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "Consumption_COICOP",
    "BASE_CONSUMPTION_COICOP",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "COICOP I": _subscript_dict["COICOP I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "COICOP I": _subscript_dict["COICOP I"],
    },
    "_ext_constant_initial_consumption_coicop",
)


@component.add(
    name="INITIAL FINAL ENERGY CONSUMPTION HOUSEHOLDS BY FE",
    units="TJ/Year",
    subscripts=["REGIONS 35 I", "NRG FE I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "initial_final_energy_consumption_households_by_fe_buildings": 1,
        "initial_final_energy_consumption_households_by_fe_transport": 1,
    },
)
def initial_final_energy_consumption_households_by_fe():
    """
    Initial households final energy consumption by final energy.
    """
    return (
        initial_final_energy_consumption_households_by_fe_buildings()
        + initial_final_energy_consumption_households_by_fe_transport()
    )


@component.add(
    name="INITIAL HOUSEHOLDS CONSUMPTION DURABLES REAL",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_consumption_durables_real": 1},
    other_deps={
        "_initial_initial_households_consumption_durables_real": {
            "initial": {"aux_households_consumption_durables_real": 1},
            "step": {},
        }
    },
)
def initial_households_consumption_durables_real():
    return _initial_initial_households_consumption_durables_real()


_initial_initial_households_consumption_durables_real = Initial(
    lambda: aux_households_consumption_durables_real(),
    "_initial_initial_households_consumption_durables_real",
)


@component.add(
    name="INITIAL HOUSEHOLDS CONSUMPTION NON DURABLES REAL",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_consumption_non_durables_real": 1},
    other_deps={
        "_initial_initial_households_consumption_non_durables_real": {
            "initial": {"aux_households_consumption_non_durables_real": 1},
            "step": {},
        }
    },
)
def initial_households_consumption_non_durables_real():
    return _initial_initial_households_consumption_non_durables_real()


_initial_initial_households_consumption_non_durables_real = Initial(
    lambda: aux_households_consumption_non_durables_real(),
    "_initial_initial_households_consumption_non_durables_real",
)


@component.add(
    name="INITIAL HOUSEHOLDS CONSUMPTION PROPENSITY DURABLES",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP DURABLES I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_consumption_propensity_durables": 1},
    other_deps={
        "_initial_initial_households_consumption_propensity_durables": {
            "initial": {"households_consumption_propensity_durables_non_smooth": 1},
            "step": {},
        }
    },
)
def initial_households_consumption_propensity_durables():
    """
    Initial households consumption propensity of durable goods: non smooth
    """
    return _initial_initial_households_consumption_propensity_durables()


_initial_initial_households_consumption_propensity_durables = Initial(
    lambda: households_consumption_propensity_durables_non_smooth(),
    "_initial_initial_households_consumption_propensity_durables",
)


@component.add(
    name="INITIAL HOUSEHOLDS CONSUMPTION PROPENSITY NON DURABLES",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_consumption_propensity_non_durables": 1},
    other_deps={
        "_initial_initial_households_consumption_propensity_non_durables": {
            "initial": {"households_consumption_propensity_non_durables_non_smooth": 1},
            "step": {},
        }
    },
)
def initial_households_consumption_propensity_non_durables():
    """
    Initial households consumption propensity of non durable goods: non smooth
    """
    return _initial_initial_households_consumption_propensity_non_durables()


_initial_initial_households_consumption_propensity_non_durables = Initial(
    lambda: households_consumption_propensity_non_durables_non_smooth(),
    "_initial_initial_households_consumption_propensity_non_durables",
)


@component.add(
    name="INITIAL HOUSEHOLDS CONSUMPTION TRANSPORT BOTTOM UP",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSP ENERGY I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_consumption_transport_bottom_up": 1},
    other_deps={
        "_initial_initial_households_consumption_transport_bottom_up": {
            "initial": {"households_consumption_transport_bottom_up": 1},
            "step": {},
        }
    },
)
def initial_households_consumption_transport_bottom_up():
    """
    Initial households consumption of transportation (public and fuel) by household type
    """
    return _initial_initial_households_consumption_transport_bottom_up()


_initial_initial_households_consumption_transport_bottom_up = Initial(
    lambda: households_consumption_transport_bottom_up(),
    "_initial_initial_households_consumption_transport_bottom_up",
)


@component.add(
    name="INITIAL HOUSEHOLDS DISPOSABLE INCOME",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_disposable_income": 1},
    other_deps={
        "_initial_initial_households_disposable_income": {
            "initial": {"households_disposable_income": 1},
            "step": {},
        }
    },
)
def initial_households_disposable_income():
    """
    Initial households disposable income by household type.
    """
    return _initial_initial_households_disposable_income()


_initial_initial_households_disposable_income = Initial(
    lambda: households_disposable_income(),
    "_initial_initial_households_disposable_income",
)


@component.add(
    name="initial households disposable income real 12 types",
    units="dollars 2015/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "HOUSEHOLDS DEMOGRAPHY I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "households_correspondance_12_to_60": 1,
        "initial_households_disposable_income": 1,
        "dollars_per_dollars_2015": 1,
    },
)
def initial_households_disposable_income_real_12_types():
    """
    Initial households disposable income by household type (12 types: 6 composition x 2 rural/urban) in real terms
    """
    return (
        households_correspondance_12_to_60()
        * initial_households_disposable_income().transpose(
            "HOUSEHOLDS I", "REGIONS 35 I"
        )
        / dollars_per_dollars_2015()
    ).transpose("REGIONS 35 I", "HOUSEHOLDS I", "HOUSEHOLDS DEMOGRAPHY I")


@component.add(
    name="INITIAL HOUSEHOLDS ENERGY TRANSPORT CONSUMPTION COICOP",
    units="TJ/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP ENERGY I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_energy_transport_consumption_coicop": 1},
    other_deps={
        "_initial_initial_households_energy_transport_consumption_coicop": {
            "initial": {"households_energy_transport_consumption_coicop": 1},
            "step": {},
        }
    },
)
def initial_households_energy_transport_consumption_coicop():
    """
    Initial household energy consumption for transportation by household type in physical untis.
    """
    return _initial_initial_households_energy_transport_consumption_coicop()


_initial_initial_households_energy_transport_consumption_coicop = Initial(
    lambda: households_energy_transport_consumption_coicop(),
    "_initial_initial_households_energy_transport_consumption_coicop",
)


@component.add(
    name="INITIAL HOUSEHOLDS LABOUR COMPENSATION",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "base_number_of_households": 1,
        "initial_labour_compensation": 1,
        "labour_compensation_share": 1,
        "unit_conversion_dollars_mdollars": 1,
    },
)
def initial_households_labour_compensation():
    """
    Inital household labour compensation
    """
    return (
        zidz(
            xr.DataArray(
                1,
                {
                    "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                    "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                },
                ["REGIONS 35 I", "HOUSEHOLDS I"],
            ),
            base_number_of_households(),
        )
        * sum(
            initial_labour_compensation().rename({"SECTORS I": "SECTORS I!"}),
            dim=["SECTORS I!"],
        )
        * labour_compensation_share()
        * unit_conversion_dollars_mdollars()
    )


@component.add(
    name="INITIAL HOUSEHOLDS NET OPERATING SURPLUS",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "base_number_of_households": 1,
        "operating_surplus_share": 1,
        "initial_net_operating_surplus": 1,
        "initial_tax_income_corporations": 1,
        "share_operating_surplus_distributed": 1,
        "unit_conversion_dollars_mdollars": 1,
    },
)
def initial_households_net_operating_surplus():
    """
    Initial households net operating surplus
    """
    return (
        zidz(
            xr.DataArray(
                1,
                {
                    "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                    "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                },
                ["REGIONS 35 I", "HOUSEHOLDS I"],
            ),
            base_number_of_households(),
        )
        * operating_surplus_share()
        * (initial_net_operating_surplus() - initial_tax_income_corporations())
        * share_operating_surplus_distributed()
        * unit_conversion_dollars_mdollars()
    )


@component.add(
    name="INITIAL HOUSEHOLDS PROPERTY INCOME RECEIVED",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_initial_households_property_income_received"
    },
)
def initial_households_property_income_received():
    """
    Intial households property income received by household type.
    """
    return _ext_constant_initial_households_property_income_received()


_ext_constant_initial_households_property_income_received = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "HH_Property_income_rec",
    "INITIAL_HOUSEHOLDS_PROPERTY_INCOME_RECEIVED",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_initial_households_property_income_received",
)


@component.add(
    name="INITIAL HOUSEHOLDS PUBLIC TRANSPORT DEMAND COICOP",
    units="(km*person)/households",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSPORT EXC FUEL I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_initial_households_public_transport_demand_coicop": 1},
    other_deps={
        "_initial_initial_households_public_transport_demand_coicop": {
            "initial": {"households_public_households_transport_demand_coicop": 1},
            "step": {},
        }
    },
)
def initial_households_public_transport_demand_coicop():
    """
    Inital public transport demand
    """
    return _initial_initial_households_public_transport_demand_coicop()


_initial_initial_households_public_transport_demand_coicop = Initial(
    lambda: households_public_households_transport_demand_coicop(),
    "_initial_initial_households_public_transport_demand_coicop",
)


@component.add(
    name="INITIAL HOUSEHOLDS SOCIAL BENEFITS",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "base_number_of_households": 1,
        "social_benefits_share": 1,
        "initial_social_benefits": 1,
        "unit_conversion_dollars_mdollars": 1,
    },
)
def initial_households_social_benefits():
    """
    Inital households social benefits
    """
    return (
        zidz(
            xr.DataArray(
                1,
                {
                    "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                    "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                },
                ["REGIONS 35 I", "HOUSEHOLDS I"],
            ),
            base_number_of_households(),
        )
        * social_benefits_share()
        * initial_social_benefits()
        * unit_conversion_dollars_mdollars()
    )


@component.add(
    name="INITIAL LIMIT ANNUAL GROWTH CONSUMPTION DURABLES SP",
    units="Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_initial_limit_annual_growth_consumption_durables_sp"
    },
)
def initial_limit_annual_growth_consumption_durables_sp():
    """
    Inital year maximum anual growth consumption durables
    """
    return _ext_constant_initial_limit_annual_growth_consumption_durables_sp()


_ext_constant_initial_limit_annual_growth_consumption_durables_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "INITIAL_LIMIT_ANNUAL_GROWTH_CONSUMPTION_DURABLES_SP*",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_initial_limit_annual_growth_consumption_durables_sp",
)


@component.add(
    name="INITIAL LIMIT ANNUAL GROWTH CONSUMPTION NON DURABLES SP",
    units="Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_initial_limit_annual_growth_consumption_non_durables_sp"
    },
)
def initial_limit_annual_growth_consumption_non_durables_sp():
    """
    Inital year maximum anual growth consumption non durables
    """
    return _ext_constant_initial_limit_annual_growth_consumption_non_durables_sp()


_ext_constant_initial_limit_annual_growth_consumption_non_durables_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "INITIAL_LIMIT_ANNUAL_GROWTH_CONSUMPTION_NON_DURABLES_SP*",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_initial_limit_annual_growth_consumption_non_durables_sp",
)


@component.add(
    name="INITIAL YEAR TAX RATE INCOME SP",
    units="Year",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_initial_year_tax_rate_income_sp"},
)
def initial_year_tax_rate_income_sp():
    return _ext_constant_initial_year_tax_rate_income_sp()


_ext_constant_initial_year_tax_rate_income_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "INITIAL_YEAR_TAX_RATE_INCOME_SP",
    {},
    _root,
    {},
    "_ext_constant_initial_year_tax_rate_income_sp",
)


@component.add(
    name="INITIAL YEAR TAX RATE SOCIAL SECURITY SP",
    units="Year",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_initial_year_tax_rate_social_security_sp"
    },
)
def initial_year_tax_rate_social_security_sp():
    """
    Initial year social security contrubutions rate over gross labour compensation
    """
    return _ext_constant_initial_year_tax_rate_social_security_sp()


_ext_constant_initial_year_tax_rate_social_security_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "INITIAL_YEAR_TAX_RATE_SOCIAL_SECURITY_SP",
    {},
    _root,
    {},
    "_ext_constant_initial_year_tax_rate_social_security_sp",
)


@component.add(
    name="INITIAL YEAR TAX RATE WEALTH SP",
    units="Year",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_initial_year_tax_rate_wealth_sp"},
)
def initial_year_tax_rate_wealth_sp():
    """
    Initial year tax rate wealth
    """
    return _ext_constant_initial_year_tax_rate_wealth_sp()


_ext_constant_initial_year_tax_rate_wealth_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "INITIAL_YEAR_TAX_RATE_WEALTH_SP",
    {},
    _root,
    {},
    "_ext_constant_initial_year_tax_rate_wealth_sp",
)


@component.add(
    name="labour compensation non adjusted",
    units="Mdollars/Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "delayed_ts_labour_compensation_per_household": 2,
        "unit_conversion_dollars_mdollars": 2,
        "base_number_of_households": 1,
        "number_of_households_by_income_and_type": 1,
    },
)
def labour_compensation_non_adjusted():
    """
    Labour compensation non adjusted
    """
    return if_then_else(
        time() <= 2015,
        lambda: sum(
            delayed_ts_labour_compensation_per_household().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * base_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"}),
            dim=["HOUSEHOLDS I!"],
        )
        / unit_conversion_dollars_mdollars(),
        lambda: sum(
            delayed_ts_labour_compensation_per_household().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * number_of_households_by_income_and_type().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            ),
            dim=["HOUSEHOLDS I!"],
        )
        / unit_conversion_dollars_mdollars(),
    )


@component.add(
    name="LIMIT ANNUAL GROWTH CONSUMPTION DURABLES SP",
    units="DMNL/Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_limit_annual_growth_consumption_durables_sp"
    },
)
def limit_annual_growth_consumption_durables_sp():
    """
    Limit to annual growth in the consumption of durables
    """
    return _ext_constant_limit_annual_growth_consumption_durables_sp()


_ext_constant_limit_annual_growth_consumption_durables_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "LIMIT_ANNUAL_GROWTH_CONSUMPTION_DURABLES_SP*",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_limit_annual_growth_consumption_durables_sp",
)


@component.add(
    name="LIMIT ANNUAL GROWTH CONSUMPTION NON DURABLES SP",
    units="DMNL/Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_limit_annual_growth_consumption_non_durables_sp"
    },
)
def limit_annual_growth_consumption_non_durables_sp():
    """
    Limit to annual growth in the consumption of non durables
    """
    return _ext_constant_limit_annual_growth_consumption_non_durables_sp()


_ext_constant_limit_annual_growth_consumption_non_durables_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "LIMIT_ANNUAL_GROWTH_CONSUMPTION_NON_DURABLES_SP*",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_limit_annual_growth_consumption_non_durables_sp",
)


@component.add(
    name="LIMIT CONSUMPTION ENERGY OVER TOTAL NON DURABLES",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_limit_consumption_energy_over_total_non_durables"
    },
)
def limit_consumption_energy_over_total_non_durables():
    """
    Limit to the consumption of energy over total consumption of non durables.
    """
    return _ext_constant_limit_consumption_energy_over_total_non_durables()


_ext_constant_limit_consumption_energy_over_total_non_durables = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "LIMIT_CONSUMPTION_ENERGY_OVER_TOTAL_NON_DURABLES",
    {},
    _root,
    {},
    "_ext_constant_limit_consumption_energy_over_total_non_durables",
)


@component.add(
    name="LOCKDOWN HOUSEHOLDS TRANSPORT DEMAND VARIATION SP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_lockdown_households_transport_demand_variation_sp"
    },
)
def lockdown_households_transport_demand_variation_sp():
    """
    Effect of lockdown on passenger transport.
    """
    return _ext_constant_lockdown_households_transport_demand_variation_sp()


_ext_constant_lockdown_households_transport_demand_variation_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "LOCKDOWN_HOUSEHOLDS_TRANSPORT_DEMAND_VARIATION_SP",
    {},
    _root,
    {},
    "_ext_constant_lockdown_households_transport_demand_variation_sp",
)


@component.add(
    name="net operating surplus non adjusted",
    units="Mdollars/Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "unit_conversion_dollars_mdollars": 2,
        "delayed_ts_net_operating_surplus_per_hh": 2,
        "base_number_of_households": 1,
        "number_of_households_by_income_and_type": 1,
    },
)
def net_operating_surplus_non_adjusted():
    """
    Net operating surplus not adjusted
    """
    return if_then_else(
        time() <= 2015,
        lambda: sum(
            delayed_ts_net_operating_surplus_per_hh().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * base_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"}),
            dim=["HOUSEHOLDS I!"],
        )
        / unit_conversion_dollars_mdollars(),
        lambda: sum(
            delayed_ts_net_operating_surplus_per_hh().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * number_of_households_by_income_and_type().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            ),
            dim=["HOUSEHOLDS I!"],
        )
        / unit_conversion_dollars_mdollars(),
    )


@component.add(
    name="number of households by income and type",
    units="households",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 8,
        "base_number_of_households": 16,
        "switch_eco_households": 8,
        "households_correspondance_12_to_60": 1,
        "switch_economy": 8,
        "households_shares_by_income": 8,
        "switch_dem2eco_number_households": 8,
        "number_households_by_type_eu27_adjusted": 1,
        "number_households_noneu": 1,
        "number_households_by_type_eu27": 6,
    },
)
def number_of_households_by_income_and_type():
    """
    Number of households by income group and type.
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I"],
    )
    value.loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :] = if_then_else(
        time() <= 2015,
        lambda: base_number_of_households()
        .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :]
        .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
        lambda: if_then_else(
            np.logical_or(
                switch_economy() == 0,
                np.logical_or(
                    switch_eco_households() == 0,
                    switch_dem2eco_number_households() == 0,
                ),
            ),
            lambda: base_number_of_households()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :]
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
            lambda: sum(
                number_households_by_type_eu27_adjusted()
                .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :]
                .rename(
                    {
                        "REGIONS EU27 I": "REGIONS DISAGGREGATED HH I",
                        "HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!",
                    }
                )
                * households_correspondance_12_to_60()
                .rename({"HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!"})
                .transpose("HOUSEHOLDS DEMOGRAPHY I!", "HOUSEHOLDS I"),
                dim=["HOUSEHOLDS DEMOGRAPHY I!"],
            )
            * households_shares_by_income()
            .loc[_subscript_dict["REGIONS DISAGGREGATED HH I"], :]
            .rename({"REGIONS 35 I": "REGIONS DISAGGREGATED HH I"}),
        ),
    ).values
    value.loc[_subscript_dict["REGIONS 8 I"], :] = if_then_else(
        time() <= 2015,
        lambda: base_number_of_households()
        .loc[_subscript_dict["REGIONS 8 I"], :]
        .rename({"REGIONS 35 I": "REGIONS 8 I"}),
        lambda: if_then_else(
            np.logical_or(
                switch_economy() == 0,
                np.logical_or(
                    switch_eco_households() == 0,
                    switch_dem2eco_number_households() == 0,
                ),
            ),
            lambda: base_number_of_households()
            .loc[_subscript_dict["REGIONS 8 I"], :]
            .rename({"REGIONS 35 I": "REGIONS 8 I"}),
            lambda: number_households_noneu()
            * households_shares_by_income()
            .loc[_subscript_dict["REGIONS 8 I"], :]
            .rename({"REGIONS 35 I": "REGIONS 8 I"}),
        ),
    ).values
    value.loc[["AUSTRIA"], :] = (
        if_then_else(
            time() <= 2015,
            lambda: base_number_of_households()
            .loc["AUSTRIA", :]
            .reset_coords(drop=True),
            lambda: if_then_else(
                np.logical_or(
                    switch_economy() == 0,
                    np.logical_or(
                        switch_dem2eco_number_households() == 0,
                        switch_eco_households() == 0,
                    ),
                ),
                lambda: base_number_of_households()
                .loc["AUSTRIA", :]
                .reset_coords(drop=True),
                lambda: sum(
                    number_households_by_type_eu27()
                    .loc["AUSTRIA", :]
                    .reset_coords(drop=True)
                    .rename({"HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!"}),
                    dim=["HOUSEHOLDS DEMOGRAPHY I!"],
                )
                * households_shares_by_income()
                .loc["AUSTRIA", :]
                .reset_coords(drop=True),
            ),
        )
        .expand_dims({"REGIONS 35 I": ["AUSTRIA"]}, 0)
        .values
    )
    value.loc[["ITALY"], :] = (
        if_then_else(
            time() <= 2015,
            lambda: base_number_of_households().loc["ITALY", :].reset_coords(drop=True),
            lambda: if_then_else(
                np.logical_or(
                    switch_economy() == 0,
                    np.logical_or(
                        switch_dem2eco_number_households() == 0,
                        switch_eco_households() == 0,
                    ),
                ),
                lambda: base_number_of_households()
                .loc["ITALY", :]
                .reset_coords(drop=True),
                lambda: sum(
                    number_households_by_type_eu27()
                    .loc["ITALY", :]
                    .reset_coords(drop=True)
                    .rename({"HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!"}),
                    dim=["HOUSEHOLDS DEMOGRAPHY I!"],
                )
                * households_shares_by_income().loc["ITALY", :].reset_coords(drop=True),
            ),
        )
        .expand_dims({"REGIONS 35 I": ["ITALY"]}, 0)
        .values
    )
    value.loc[["MALTA"], :] = (
        if_then_else(
            time() <= 2015,
            lambda: base_number_of_households().loc["MALTA", :].reset_coords(drop=True),
            lambda: if_then_else(
                np.logical_or(
                    switch_economy() == 0,
                    np.logical_or(
                        switch_dem2eco_number_households() == 0,
                        switch_eco_households() == 0,
                    ),
                ),
                lambda: base_number_of_households()
                .loc["MALTA", :]
                .reset_coords(drop=True),
                lambda: sum(
                    number_households_by_type_eu27()
                    .loc["MALTA", :]
                    .reset_coords(drop=True)
                    .rename({"HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!"}),
                    dim=["HOUSEHOLDS DEMOGRAPHY I!"],
                )
                * households_shares_by_income().loc["MALTA", :].reset_coords(drop=True),
            ),
        )
        .expand_dims({"REGIONS 35 I": ["MALTA"]}, 0)
        .values
    )
    value.loc[["NETHERLANDS"], :] = (
        if_then_else(
            time() <= 2015,
            lambda: base_number_of_households()
            .loc["NETHERLANDS", :]
            .reset_coords(drop=True),
            lambda: if_then_else(
                np.logical_or(
                    switch_economy() == 0,
                    np.logical_or(
                        switch_dem2eco_number_households() == 0,
                        switch_eco_households() == 0,
                    ),
                ),
                lambda: base_number_of_households()
                .loc["NETHERLANDS", :]
                .reset_coords(drop=True),
                lambda: sum(
                    number_households_by_type_eu27()
                    .loc["NETHERLANDS", :]
                    .reset_coords(drop=True)
                    .rename({"HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!"}),
                    dim=["HOUSEHOLDS DEMOGRAPHY I!"],
                )
                * households_shares_by_income()
                .loc["NETHERLANDS", :]
                .reset_coords(drop=True),
            ),
        )
        .expand_dims({"REGIONS 35 I": ["NETHERLANDS"]}, 0)
        .values
    )
    value.loc[["ROMANIA"], :] = (
        if_then_else(
            time() <= 2015,
            lambda: base_number_of_households()
            .loc["ROMANIA", :]
            .reset_coords(drop=True),
            lambda: if_then_else(
                np.logical_or(
                    switch_economy() == 0,
                    np.logical_or(
                        switch_dem2eco_number_households() == 0,
                        switch_eco_households() == 0,
                    ),
                ),
                lambda: base_number_of_households()
                .loc["ROMANIA", :]
                .reset_coords(drop=True),
                lambda: sum(
                    number_households_by_type_eu27()
                    .loc["ROMANIA", :]
                    .reset_coords(drop=True)
                    .rename({"HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!"}),
                    dim=["HOUSEHOLDS DEMOGRAPHY I!"],
                )
                * households_shares_by_income()
                .loc["ROMANIA", :]
                .reset_coords(drop=True),
            ),
        )
        .expand_dims({"REGIONS 35 I": ["ROMANIA"]}, 0)
        .values
    )
    value.loc[["SLOVENIA"], :] = (
        if_then_else(
            time() <= 2015,
            lambda: base_number_of_households()
            .loc["SLOVENIA", :]
            .reset_coords(drop=True),
            lambda: if_then_else(
                np.logical_or(
                    switch_economy() == 0,
                    np.logical_or(
                        switch_dem2eco_number_households() == 0,
                        switch_eco_households() == 0,
                    ),
                ),
                lambda: base_number_of_households()
                .loc["SLOVENIA", :]
                .reset_coords(drop=True),
                lambda: sum(
                    number_households_by_type_eu27()
                    .loc["SLOVENIA", :]
                    .reset_coords(drop=True)
                    .rename({"HOUSEHOLDS DEMOGRAPHY I": "HOUSEHOLDS DEMOGRAPHY I!"}),
                    dim=["HOUSEHOLDS DEMOGRAPHY I!"],
                )
                * households_shares_by_income()
                .loc["SLOVENIA", :]
                .reset_coords(drop=True),
            ),
        )
        .expand_dims({"REGIONS 35 I": ["SLOVENIA"]}, 0)
        .values
    )
    return value


@component.add(
    name="price non durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"delayed_ts_shares_consumption_non_durables": 1, "price_coicop": 1},
)
def price_non_durables():
    """
    Aggregated price of non durables by household
    """
    return sum(
        delayed_ts_shares_consumption_non_durables().rename(
            {"COICOP NON DURABLES I": "COICOP NON DURABLES I!"}
        )
        * price_coicop()
        .loc[:, _subscript_dict["COICOP NON DURABLES I"]]
        .rename({"COICOP I": "COICOP NON DURABLES I!"}),
        dim=["COICOP NON DURABLES I!"],
    )


@component.add(
    name="price QUAIDS 1",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "delayed_ts_households_share_quaids": 2,
        "price_coicop": 2,
        "price_transformation": 4,
    },
)
def price_quaids_1():
    """
    Price 1 of the QUAIDS model.
    """
    return np.maximum(
        10,
        if_then_else(
            sum(
                delayed_ts_households_share_quaids().rename({"QUAIDS I": "QUAIDS I!"})
                * (
                    np.log(
                        zidz(
                            price_coicop()
                            .loc[:, _subscript_dict["QUAIDS I"]]
                            .rename({"COICOP I": "QUAIDS I!"}),
                            price_transformation(),
                        )
                    )
                    + 1
                ),
                dim=["QUAIDS I!"],
            )
            * price_transformation()
            <= 0,
            lambda: xr.DataArray(
                0,
                {
                    "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                    "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                },
                ["REGIONS 35 I", "HOUSEHOLDS I"],
            ),
            lambda: sum(
                delayed_ts_households_share_quaids().rename({"QUAIDS I": "QUAIDS I!"})
                * (
                    np.log(
                        zidz(
                            price_coicop()
                            .loc[:, _subscript_dict["QUAIDS I"]]
                            .rename({"COICOP I": "QUAIDS I!"}),
                            price_transformation(),
                        )
                    )
                    + 1
                ),
                dim=["QUAIDS I!"],
            )
            * price_transformation(),
        ),
    )


@component.add(
    name="price QUAIDS 2",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "delayed_ts_households_share_quaids": 1,
        "epsilon_quaids": 1,
        "price_transformation": 1,
    },
)
def price_quaids_2():
    """
    Price 2 of the QUAIDS model.
    """
    return (
        prod(
            (
                delayed_ts_households_share_quaids().rename({"QUAIDS I": "QUAIDS I!"})
                + 1e-07
            )
            ** epsilon_quaids().rename({"QUAIDS I": "QUAIDS I!"}),
            dim=["QUAIDS I!"],
        )
        * price_transformation()
    )


@component.add(
    name="price transport",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"delayed_ts_shares_consumption_transportation": 1, "price_coicop": 1},
)
def price_transport():
    """
    Aggregated price of transportation by households type
    """
    return sum(
        delayed_ts_shares_consumption_transportation().rename(
            {"COICOP TRANSPORT I": "COICOP TRANSPORT I!"}
        )
        * price_coicop()
        .loc[:, _subscript_dict["COICOP TRANSPORT I"]]
        .rename({"COICOP I": "COICOP TRANSPORT I!"}),
        dim=["COICOP TRANSPORT I!"],
    )


@component.add(
    name="public transport demand COICOP physical units",
    units="km*person",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSPORT EXC FUEL I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"passenger_transport_demand_public_fleet": 6},
)
def public_transport_demand_coicop_physical_units():
    """
    Transport demand in COICOP classification, physilca units
    """
    value = xr.DataArray(
        np.nan,
        {
            "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
            "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
            "COICOP TRANSPORT EXC FUEL I": _subscript_dict[
                "COICOP TRANSPORT EXC FUEL I"
            ],
        },
        ["REGIONS 35 I", "HOUSEHOLDS I", "COICOP TRANSPORT EXC FUEL I"],
    )
    value.loc[:, :, ["HH ROAD"]] = (
        passenger_transport_demand_public_fleet()
        .loc[:, "BUS", :]
        .reset_coords(drop=True)
        .expand_dims({"COICOP I": ["HH ROAD"]}, 2)
        .values
    )
    value.loc[:, :, ["HH RAILWAY"]] = (
        passenger_transport_demand_public_fleet()
        .loc[:, "RAIL", :]
        .reset_coords(drop=True)
        .expand_dims({"COICOP I": ["HH RAILWAY"]}, 2)
        .values
    )
    value.loc[:, :, ["HH MARITIME"]] = (
        passenger_transport_demand_public_fleet()
        .loc[:, "MARINE", :]
        .reset_coords(drop=True)
        .expand_dims({"COICOP I": ["HH MARITIME"]}, 2)
        .values
    )
    value.loc[:, :, ["HH AIR"]] = (
        (
            passenger_transport_demand_public_fleet()
            .loc[:, "AIR DOMESTIC", :]
            .reset_coords(drop=True)
            + passenger_transport_demand_public_fleet()
            .loc[:, "AIR INTRA EU", :]
            .reset_coords(drop=True)
            + passenger_transport_demand_public_fleet()
            .loc[:, "AIR INTERNATIONAL", :]
            .reset_coords(drop=True)
        )
        .expand_dims({"COICOP I": ["HH AIR"]}, 2)
        .values
    )
    return value


@component.add(
    name="ratio household consumpion transport energy to total non durables",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "total_households_consumption_transport_energy_top_down": 1,
        "households_consumption_non_durables": 1,
    },
)
def ratio_household_consumpion_transport_energy_to_total_non_durables():
    """
    Ratio total household consumption of energy and transport to total consumption of non durables.
    """
    return zidz(
        total_households_consumption_transport_energy_top_down(),
        households_consumption_non_durables(),
    )


@component.add(
    name="SELECT LIMIT ANNUAL GROWTH CONSUMPTION DURABLES SP",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_select_limit_annual_growth_consumption_durables_sp"
    },
)
def select_limit_annual_growth_consumption_durables_sp():
    """
    Select maximum annual growth consumption durables: 0: No limit 1: Limit
    """
    return _ext_constant_select_limit_annual_growth_consumption_durables_sp()


_ext_constant_select_limit_annual_growth_consumption_durables_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "SELECT_LIMIT_ANNUAL_GROWTH_CONSUMPTION_DURABLES_SP*",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_select_limit_annual_growth_consumption_durables_sp",
)


@component.add(
    name="SELECT LIMIT ANNUAL GROWTH CONSUMPTION NON DURABLES SP",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_select_limit_annual_growth_consumption_non_durables_sp"
    },
)
def select_limit_annual_growth_consumption_non_durables_sp():
    """
    Select maximum annual growth consumption non durables: 0: No limit 1: Limit
    """
    return _ext_constant_select_limit_annual_growth_consumption_non_durables_sp()


_ext_constant_select_limit_annual_growth_consumption_non_durables_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "SELECT_LIMIT_ANNUAL_GROWTH_CONSUMPTION_NON_DURABLES_SP*",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_select_limit_annual_growth_consumption_non_durables_sp",
)


@component.add(
    name="SELECT LIMIT CONSUMPTION ENERGY OVER TOTAL NON DURABLES SP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_select_limit_consumption_energy_over_total_non_durables_sp"
    },
)
def select_limit_consumption_energy_over_total_non_durables_sp():
    """
    Limit to the consumption of energy over total non durables. 0: No limit 1: Limit
    """
    return _ext_constant_select_limit_consumption_energy_over_total_non_durables_sp()


_ext_constant_select_limit_consumption_energy_over_total_non_durables_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "SELECT_LIMIT_CONSUMPTION_ENERGY_OVER_TOTAL_NON_DURABLES_SP",
    {},
    _root,
    {},
    "_ext_constant_select_limit_consumption_energy_over_total_non_durables_sp",
)


@component.add(
    name="SELECT LOCKDOWN EFFECT ON HOUSEHOLDS TRANSPORT SP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_select_lockdown_effect_on_households_transport_sp"
    },
)
def select_lockdown_effect_on_households_transport_sp():
    """
    Switch for lockdown shock on passenger Transport. 0: No lockdown 1: Lockdown scenario reduces passenger transport.
    """
    return _ext_constant_select_lockdown_effect_on_households_transport_sp()


_ext_constant_select_lockdown_effect_on_households_transport_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "SELECT_LOCKDOWN_EFFECT_ON_TRANSPORT_SP",
    {},
    _root,
    {},
    "_ext_constant_select_lockdown_effect_on_households_transport_sp",
)


@component.add(
    name="SELECT TAX RATE INCOME SP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_select_tax_rate_income_sp"},
)
def select_tax_rate_income_sp():
    """
    Income tax rate 0: Default 1: User defined
    """
    return _ext_constant_select_tax_rate_income_sp()


_ext_constant_select_tax_rate_income_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "SELECT_TAX_RATE_INCOME_SP",
    {},
    _root,
    {},
    "_ext_constant_select_tax_rate_income_sp",
)


@component.add(
    name="SELECT TAX RATE SOCIAL SECURITY SP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_select_tax_rate_social_security_sp"},
)
def select_tax_rate_social_security_sp():
    """
    Select social security contrubutions rate over gross labour compensation 0: Default 1: User defined
    """
    return _ext_constant_select_tax_rate_social_security_sp()


_ext_constant_select_tax_rate_social_security_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "SELECT_TAX_RATE_SOCIAL_SECURITY_SP",
    {},
    _root,
    {},
    "_ext_constant_select_tax_rate_social_security_sp",
)


@component.add(
    name="SELECT TAX RATE WEALTH SP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_select_tax_rate_wealth_sp"},
)
def select_tax_rate_wealth_sp():
    """
    Tax rate wealth: 0: Default 1: User defined
    """
    return _ext_constant_select_tax_rate_wealth_sp()


_ext_constant_select_tax_rate_wealth_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "SELECT_TAX_RATE_WEALTH_SP",
    {},
    _root,
    {},
    "_ext_constant_select_tax_rate_wealth_sp",
)


@component.add(
    name="SHARE ENERGY CONSUMPTION SOLID BIO VS SOLID FOSSIL",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Stateful",
    comp_subtype="Initial",
    depends_on={"_initial_share_energy_consumption_solid_bio_vs_solid_fossil": 1},
    other_deps={
        "_initial_share_energy_consumption_solid_bio_vs_solid_fossil": {
            "initial": {
                "initial_final_energy_consumption_households_by_fe_buildings": 3
            },
            "step": {},
        }
    },
)
def share_energy_consumption_solid_bio_vs_solid_fossil():
    """
    Share of solid biomass consumption of hosuehodsl over tota solid energy (biomass plus solid fossil)
    """
    return _initial_share_energy_consumption_solid_bio_vs_solid_fossil()


_initial_share_energy_consumption_solid_bio_vs_solid_fossil = Initial(
    lambda: initial_final_energy_consumption_households_by_fe_buildings()
    .loc[:, "FE solid bio"]
    .reset_coords(drop=True)
    / (
        initial_final_energy_consumption_households_by_fe_buildings()
        .loc[:, "FE solid bio"]
        .reset_coords(drop=True)
        + initial_final_energy_consumption_households_by_fe_buildings()
        .loc[:, "FE solid fossil"]
        .reset_coords(drop=True)
    ),
    "_initial_share_energy_consumption_solid_bio_vs_solid_fossil",
)


@component.add(
    name="SHARE OPERATING SURPLUS DISTRIBUTED",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_share_operating_surplus_distributed"},
)
def share_operating_surplus_distributed():
    """
    Share of net operating surplus distributed to households
    """
    return _ext_constant_share_operating_surplus_distributed()


_ext_constant_share_operating_surplus_distributed = ExtConstant(
    "model_parameters/economy/Consumption.xlsx",
    "EXO_Share_Op_Surp_distributed",
    "SHARE_OPERATING_SURPLUS_DISTRIBUTED",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_share_operating_surplus_distributed",
)


@component.add(
    name="shares households income tax",
    units="1",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_income_tax_exc_ghg_tax_reductions": 2},
)
def shares_households_income_tax():
    """
    Share of income taxes paid by each household
    """
    return zidz(
        households_income_tax_exc_ghg_tax_reductions(),
        sum(
            households_income_tax_exc_ghg_tax_reductions().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS MAP I!"}
            ),
            dim=["HOUSEHOLDS MAP I!"],
        ).expand_dims({"HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"]}, 1),
    )


@component.add(
    name="social benefits non adjusted",
    units="Mdollars/Year",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 1,
        "unit_conversion_dollars_mdollars": 2,
        "delayed_ts_social_benefits_per_household": 2,
        "base_number_of_households": 1,
        "number_of_households_by_income_and_type": 1,
    },
)
def social_benefits_non_adjusted():
    """
    Social benefits non adjusted
    """
    return if_then_else(
        time() <= 2015,
        lambda: sum(
            delayed_ts_social_benefits_per_household().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * base_number_of_households().rename({"HOUSEHOLDS I": "HOUSEHOLDS I!"}),
            dim=["HOUSEHOLDS I!"],
        )
        / unit_conversion_dollars_mdollars(),
        lambda: sum(
            delayed_ts_social_benefits_per_household().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            )
            * number_of_households_by_income_and_type().rename(
                {"HOUSEHOLDS I": "HOUSEHOLDS I!"}
            ),
            dim=["HOUSEHOLDS I!"],
        )
        / unit_conversion_dollars_mdollars(),
    )


@component.add(
    name="SWITCH DEM2ECO NUMBER HOUSEHOLDS",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_switch_dem2eco_number_households"},
)
def switch_dem2eco_number_households():
    """
    Intermodule links SWITCH, it can take two values: 0: the link is broken, the intermodule variable is replaced by an exogenous parameter. 1: the link between modules is operational.
    """
    return _ext_constant_switch_dem2eco_number_households()


_ext_constant_switch_dem2eco_number_households = ExtConstant(
    "scenario_parameters/switches.xlsx",
    "SWITCHES",
    "SWITCH_DEM2ECO_NUMBER_HOUSEHOLDS",
    {},
    _root,
    {},
    "_ext_constant_switch_dem2eco_number_households",
)


@component.add(
    name="SWITCH ECO HH BUILDINGS ENERGY BOTTOM UP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_switch_eco_hh_buildings_energy_bottom_up"
    },
)
def switch_eco_hh_buildings_energy_bottom_up():
    """
    =0: top-down demand of energy for households buildings (coming only from the economy module) =1: bottom-up demand of energy for households buildings (coming from the energy module) -> not finished hence not working!
    """
    return _ext_constant_switch_eco_hh_buildings_energy_bottom_up()


_ext_constant_switch_eco_hh_buildings_energy_bottom_up = ExtConstant(
    "scenario_parameters/switches.xlsx",
    "SWITCHES",
    "SWITCH_ECO_HH_BUILDINGS_ENERGY_BOTTOM_UP",
    {},
    _root,
    {},
    "_ext_constant_switch_eco_hh_buildings_energy_bottom_up",
)


@component.add(
    name="SWITCH ECO HH TRANSPORT ENERGY BOTTOM UP",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_switch_eco_hh_transport_energy_bottom_up"
    },
)
def switch_eco_hh_transport_energy_bottom_up():
    """
    Switch link with bottom-up transport module 0: the module runs isolated from the bottom-up transport module 1: the module runs integrated with the bottom-up transport module
    """
    return _ext_constant_switch_eco_hh_transport_energy_bottom_up()


_ext_constant_switch_eco_hh_transport_energy_bottom_up = ExtConstant(
    "scenario_parameters/switches.xlsx",
    "SWITCHES",
    "SWITCH_ECO_HH_TRANSPORT_ENERGY_BOTTOM_UP",
    {},
    _root,
    {},
    "_ext_constant_switch_eco_hh_transport_energy_bottom_up",
)


@component.add(
    name="SWITCH ECO HOUSEHOLDS",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_switch_eco_households"},
)
def switch_eco_households():
    """
    This switch can take two values: 0: the module runs isolated from the rest of WILIAM, replacing inter(sub)module variables with exogenous parameters. 1: the module runs integrated with the rest of WILIAM.
    """
    return _ext_constant_switch_eco_households()


_ext_constant_switch_eco_households = ExtConstant(
    "scenario_parameters/switches.xlsx",
    "SWITCHES",
    "SWITCH_ECO_HOUSEHOLDS",
    {},
    _root,
    {},
    "_ext_constant_switch_eco_households",
)


@component.add(
    name="SWITCH FIN2ECO",
    units="DMNL",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_switch_fin2eco"},
)
def switch_fin2eco():
    """
    Switch link with finacial module 0: the module runs isolated from the finacial module. 1: the module runs integrated with the financial module.
    """
    return _ext_constant_switch_fin2eco()


_ext_constant_switch_fin2eco = ExtConstant(
    "scenario_parameters/switches.xlsx",
    "SWITCHES",
    "SWITCH_FINAN2ECO",
    {},
    _root,
    {},
    "_ext_constant_switch_fin2eco",
)


@component.add(
    name="TAX RATE INCOME SP",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_tax_rate_income_sp"},
)
def tax_rate_income_sp():
    return _ext_constant_tax_rate_income_sp()


_ext_constant_tax_rate_income_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "TAX_RATE_INCOME_SP",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_tax_rate_income_sp",
)


@component.add(
    name="tax rate social security",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "time": 2,
        "tax_rate_social_security_default": 2,
        "select_tax_rate_social_security_sp": 1,
        "initial_year_tax_rate_social_security_sp": 1,
        "tax_rate_social_security_sp": 1,
    },
)
def tax_rate_social_security():
    """
    Social security contrubutions rate over gross labour compensation
    """
    return if_then_else(
        time() <= 2015,
        lambda: tax_rate_social_security_default(),
        lambda: if_then_else(
            np.logical_and(
                select_tax_rate_social_security_sp() == 1,
                initial_year_tax_rate_social_security_sp() >= time(),
            ),
            lambda: tax_rate_social_security_sp(),
            lambda: tax_rate_social_security_default(),
        ),
    )


@component.add(
    name="TAX RATE SOCIAL SECURITY SP",
    units="DMNL",
    subscripts=["REGIONS 35 I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_tax_rate_social_security_sp"},
)
def tax_rate_social_security_sp():
    """
    Social security contrubutions rate over gross labour compensation
    """
    return _ext_constant_tax_rate_social_security_sp()


_ext_constant_tax_rate_social_security_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "TAX_RATE_SOCIAL_SECURITY_SP*",
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    _root,
    {"REGIONS 35 I": _subscript_dict["REGIONS 35 I"]},
    "_ext_constant_tax_rate_social_security_sp",
)


@component.add(
    name="TAX RATE WEALTH SP",
    units="DMNL",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Constant",
    comp_subtype="External",
    depends_on={"__external__": "_ext_constant_tax_rate_wealth_sp"},
)
def tax_rate_wealth_sp():
    return _ext_constant_tax_rate_wealth_sp()


_ext_constant_tax_rate_wealth_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "TAX_RATE_WEALTH_SP",
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    _root,
    {
        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
    },
    "_ext_constant_tax_rate_wealth_sp",
)


@component.add(
    name="taxable income",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "switch_economy": 1,
        "switch_fin2eco": 1,
        "households_social_security": 2,
        "initial_households_property_income_received": 1,
        "household_basic_income": 2,
        "households_other_transfers_received": 2,
        "households_net_operating_surplus": 2,
        "households_social_benefits": 2,
        "households_net_labour_income": 2,
        "households_property_income_received": 1,
    },
)
def taxable_income():
    """
    Households taxable income by household type
    """
    return if_then_else(
        np.logical_or(switch_economy() == 0, switch_fin2eco() == 0),
        lambda: households_net_labour_income()
        + households_social_security()
        + households_net_operating_surplus()
        + initial_households_property_income_received()
        + households_social_benefits()
        + households_other_transfers_received()
        + household_basic_income(),
        lambda: households_net_labour_income()
        + households_social_security()
        + households_net_operating_surplus()
        + households_property_income_received()
        + households_social_benefits()
        + households_other_transfers_received()
        + household_basic_income(),
    )


@component.add(
    name="total households consumption COICOP",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_consumption_coicop": 1},
)
def total_households_consumption_coicop():
    """
    Households consumption by household type.
    """
    return sum(
        households_consumption_coicop().rename({"COICOP I": "COICOP I!"}),
        dim=["COICOP I!"],
    )


@component.add(
    name="total households consumption purchaser prices",
    units="Mdollars/Year",
    subscripts=["REGIONS 35 I", "SECTORS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"consumption_structure_coicop": 1, "consumption_coicop": 1},
)
def total_households_consumption_purchaser_prices():
    """
    Households consumption in purchaser prices and nominal terms.
    """
    return sum(
        consumption_structure_coicop().rename({"COICOP I": "COICOP I!"})
        * consumption_coicop().rename({"COICOP I": "COICOP I!"}),
        dim=["COICOP I!"],
    )


@component.add(
    name="total households consumption transport energy top down",
    units="dollars/(Year*households)",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={"households_consumption_transport_energy_top_down_non_adjusted": 1},
)
def total_households_consumption_transport_energy_top_down():
    """
    Total households consumption in transportation and energy
    """
    return sum(
        households_consumption_transport_energy_top_down_non_adjusted().rename(
            {"COICOP TRANSP ENERGY I": "COICOP TRANSP ENERGY I!"}
        ),
        dim=["COICOP TRANSP ENERGY I!"],
    )


@component.add(
    name="transport demand by household type",
    units="km*person",
    subscripts=["REGIONS 35 I", "HOUSEHOLDS I"],
    comp_type="Auxiliary",
    comp_subtype="Normal",
    depends_on={
        "select_lockdown_effect_on_households_transport_sp": 1,
        "time": 1,
        "year_lockdown_effect_on_households_transport_sp": 1,
        "households_consumption_non_durables": 4,
        "beta_transport": 2,
        "price_transport": 4,
        "epsilon_transport": 2,
        "lockdown_households_transport_demand_variation_sp": 1,
        "price_non_durables": 4,
        "constant_transport": 2,
        "price_transformation": 4,
    },
)
def transport_demand_by_household_type():
    """
    Household transport demand
    """
    return if_then_else(
        np.logical_and(
            select_lockdown_effect_on_households_transport_sp() == 1,
            year_lockdown_effect_on_households_transport_sp() == time(),
        ),
        lambda: (1 + lockdown_households_transport_demand_variation_sp())
        * np.exp(
            constant_transport()
            + if_then_else(
                np.logical_or(
                    households_consumption_non_durables() <= 0,
                    price_non_durables() <= 0,
                ),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I"],
                ),
                lambda: beta_transport()
                * np.log(
                    households_consumption_non_durables()
                    / (price_non_durables() / price_transformation())
                ),
            )
            + if_then_else(
                price_transport() <= 0,
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I"],
                ),
                lambda: epsilon_transport()
                * np.log(price_transport() / price_transformation()),
            )
        ),
        lambda: np.exp(
            constant_transport()
            + if_then_else(
                np.logical_or(
                    households_consumption_non_durables() <= 0,
                    price_non_durables() <= 0,
                ),
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I"],
                ),
                lambda: beta_transport()
                * np.log(
                    households_consumption_non_durables()
                    / (price_non_durables() / price_transformation())
                ),
            )
            + if_then_else(
                price_transport() <= 0,
                lambda: xr.DataArray(
                    0,
                    {
                        "REGIONS 35 I": _subscript_dict["REGIONS 35 I"],
                        "HOUSEHOLDS I": _subscript_dict["HOUSEHOLDS I"],
                    },
                    ["REGIONS 35 I", "HOUSEHOLDS I"],
                ),
                lambda: epsilon_transport()
                * np.log(price_transport() / price_transformation()),
            )
        ),
    )


@component.add(
    name="YEAR LOCKDOWN EFFECT ON HOUSEHOLDS TRANSPORT SP",
    units="Year",
    comp_type="Constant",
    comp_subtype="External",
    depends_on={
        "__external__": "_ext_constant_year_lockdown_effect_on_households_transport_sp"
    },
)
def year_lockdown_effect_on_households_transport_sp():
    """
    Year of the lockdown
    """
    return _ext_constant_year_lockdown_effect_on_households_transport_sp()


_ext_constant_year_lockdown_effect_on_households_transport_sp = ExtConstant(
    "scenario_parameters/scenario_parameters.xlsx",
    "economy",
    "YEAR_LOCKDOWN_EFFECT_ON_HOUSEHOLDS_TRANSPORT_SP",
    {},
    _root,
    {},
    "_ext_constant_year_lockdown_effect_on_households_transport_sp",
)
